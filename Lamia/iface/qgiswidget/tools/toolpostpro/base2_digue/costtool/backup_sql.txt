SELECT *, MIN(ST_Distance(ST_MakeValid(Infralineaire_now.geom), ST_MakeValid(Desordre_now.geom))) AS Distance  FROM Desordre_now INNER JOIN Observation_now ON Observation_now.lid_desordre = Desordre_now.id_desordre   AND Observation_now.datetimeobservation = (SELECT MAX(A.datetimeobservation) FROM Observation_now AS A WHERE A.lid_desordre = Desordre_now.id_desordre ) INNER JOIN Infralineaire_now JOIN Zonegeo_qgis ON ST_WITHIN(ST_MakeValid(Desordre_now.geom),ST_MakeValid(Zonegeo_qgis.geom)) WHERE pk_infralineaire IN ( SELECT ROWID FROM SpatialIndex WHERE f_table_name = 'Infralineaire' AND search_frame = ST_Buffer(Desordre_now.geom, 50)) GROUP BY Desordre_now.id_desordre 