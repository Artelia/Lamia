#EXPO SELECT Propriete_option.id_propriete_option AS id_ouvrage_propriete, Propriete_option.propriete AS id_propriete, Equipement.partie AS id_partie, Equipement.equipement AS id_equipement, Infralineaire.ouvrage as num_ouvrage, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_debut WHEN Equipement.typepk = 'REC' THEN Equipement.pk_debut+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_fin END AS pk_debut, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_fin WHEN Equipement.typepk = 'REC' THEN Equipement.pk_fin+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_debut END AS pk_fin, Propriete_option.valeur, (SELECT COUNT(Equipementtemp.id_equipement) FROM Equipement AS Equipementtemp INNER JOIN Infralineaire AS Infralineairetemp ON Equipementtemp.lk_infralineaire = Infralineairetemp.id_infralineaire WHERE Equipementtemp.lk_infralineaire = Infralineaire.id_infralineaire AND Equipementtemp.equipement = Equipement.equipement  AND Equipementtemp.partie = Equipement.partie AND Equipementtemp.id_equipement < Equipement.id_equipement) AS Groupe_propriete FROM Propriete_option INNER JOIN Equipement ON Equipement.id_equipement = Propriete_option.lk_equipement INNER JOIN Infralineaire ON Equipement.lk_infralineaire = Infralineaire.id_infralineaire