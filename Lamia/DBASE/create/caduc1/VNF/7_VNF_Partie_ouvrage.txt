#EXPO  SELECT toto.num_ouvrage, toto.id_partie, min(toto.pk_debut_non_max) as pk_debut, max(toto.pk_fin_non_max) AS pk_fin, toto.qualificatif, toto.abs_debut, toto.abs_fin, toto.pr_debut, toto.pr_fin FROM( SELECT Infralineaire.ouvrage as num_ouvrage, Equipement.partie as id_partie,Equipement.id_equipement, Equipement.qualificatif, Equipement.abs_debut, Equipement.abs_fin, Equipement.pr_debut, Equipement.pr_fin, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_debut WHEN Equipement.typepk = 'REC' THEN Equipement.pk_debut+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_fin END AS pk_debut_non_max, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_fin WHEN Equipement.typepk = 'REC' THEN Equipement.pk_fin+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_debut END AS pk_fin_non_max FROM Equipement INNER JOIN Infralineaire ON Equipement.lk_infralineaire = Infralineaire.id_infralineaire ) toto GROUP BY 1,2