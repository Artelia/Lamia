#EXPO SELECT *  FROM (SELECT Desordre.id_desordre AS id_oedl, Infralineaire.ouvrage AS num_ouvrage, CASE WHEN Equipement.typepk = 'ABS' THEN Desordre.pk_debut WHEN Equipement.typepk = 'REC' THEN Desordre.pk_debut+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Desordre.pk_fin END AS pk_debut, CASE WHEN Equipement.typepk = 'ABS' THEN Desordre.pk_fin WHEN Equipement.typepk = 'REC' THEN Desordre.pk_fin+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Desordre.pk_debut END AS pk_fin, Desordre.ordre, Desordre.desordre AS id_lst_desordre_enfant, Equipement.equipement AS id_equipement, Equipement.partie AS id_partie, (SELECT COUNT(Equipementtemp.id_equipement) FROM Equipement AS Equipementtemp INNER JOIN Infralineaire AS Infralineairetemp ON Equipementtemp.lk_infralineaire = Infralineairetemp.id_infralineaire WHERE Equipementtemp.lk_infralineaire = Infralineaire.id_infralineaire AND Equipementtemp.equipement = Equipement.equipement AND Equipementtemp.partie = Equipement.partie AND Equipementtemp.id_equipement < Equipement.id_equipement) AS group_number,Observation.magnitude, Observation.state_level,Observation.travaux AS id_lst_type_travaux, Observation.description AS description, Observation.id_objet, Observation.id_observation FROM Desordre INNER JOIN Equipement ON Equipement.id_equipement = Desordre.lk_equipement INNER JOIN Infralineaire ON Equipement.lk_infralineaire = Infralineaire.id_infralineaire INNER JOIN Observation ON Desordre.id_desordre = Observation.lk_desordre  GROUP BY Desordre.id_desordre ) tmp LEFT JOIN Tcobjetressource ON tmp.id_objet = Tcobjetressource.id_tcobjet WHERE id_tcobjetressource IN (SELECT MAX(id_tcobjetressource) FROM Tcobjetressource GROUP BY id_tcobjet)