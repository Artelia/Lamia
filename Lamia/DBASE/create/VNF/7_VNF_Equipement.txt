#EXPO SELECT toto.num_ouvrage, toto.id_partie, toto.id_equipement, min(toto.pk_debut_non_max) AS pk_debut, max(toto.pk_fin_non_max) AS pk_fin, toto.pr_debut, toto.pr_fin, toto.abs_debut, toto.abs_fin, toto.forcage_ree, toto.note_ief, toto.is_modified FROM( SELECT Infralineaire.ouvrage AS num_ouvrage, Equipement.partie AS id_partie, Equipement.equipement AS id_equipement, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_debut WHEN Equipement.typepk = 'REC' THEN Equipement.pk_debut+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_fin END AS pk_debut_non_max, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_fin WHEN Equipement.typepk = 'REC' THEN Equipement.pk_fin+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_debut END AS pk_fin_non_max, Equipement.pr_debut, Equipement.pr_fin, Equipement.abs_debut, Equipement.abs_fin, Equipement.forcage_ree, Equipement.note_ief, Equipement.is_modified FROM Equipement INNER JOIN Infralineaire ON Equipement.lk_infralineaire = Infralineaire.id_infralineaire ) toto GROUP BY 1,2,3