#EXPO SELECT Infralineaire.ouvrage AS num_ouvrage, Equipement.partie AS id_partie, Equipement.equipement AS id_equipement, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_debut WHEN Equipement.typepk = 'REC' THEN Equipement.pk_debut+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_fin END AS pk_debut, CASE WHEN Equipement.typepk = 'ABS' THEN Equipement.pk_fin WHEN Equipement.typepk = 'REC' THEN Equipement.pk_fin+Infralineaire.art_pk_debut WHEN Equipement.typepk = 'RED' THEN Infralineaire.art_pk_fin-Equipement.pk_debut END AS pk_fin, Equipement.pr_debut, Equipement.pr_fin, Equipement.abs_debut, Equipement.abs_fin, Equipement.forcage_ree, Equipement.note_ief, Equipement.is_modified, (SELECT COUNT(Equipementtemp.id_equipement) FROM Equipement AS Equipementtemp INNER JOIN Infralineaire AS Infralineairetemp ON Equipementtemp.lk_infralineaire = Infralineairetemp.id_infralineaire WHERE Equipementtemp.lk_infralineaire = Infralineaire.id_infralineaire AND Equipementtemp.equipement = Equipement.equipement  AND Equipementtemp.partie = Equipement.partie AND Equipementtemp.id_equipement < Equipement.id_equipement) AS groupe_number FROM Equipement INNER JOIN Infralineaire ON Equipement.lk_infralineaire = Infralineaire.id_infralineaire