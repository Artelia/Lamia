

<!DOCTYPE html>
<html class="writer-html5" lang="fr" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget &mdash; Documentation LAMIA 1.0</title>
  

  
  <link rel="stylesheet" href="../../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../../../_static/theme_overrides.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../../../" src="../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../_static/jquery.js"></script>
        <script src="../../../../../_static/underscore.js"></script>
        <script src="../../../../../_static/doctools.js"></script>
        <script src="../../../../../_static/language_data.js"></script>
        <script src="../../../../../_static/translations.js"></script>
    
    <script type="text/javascript" src="../../../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Recherche" href="../../../../../search.html" />

<link rel="stylesheet" href="https://unpkg.com/aos@2.3.1/dist/aos.css" />
<!-- help for aos : https://michalsnik.github.io/aos/  -->

<script>

	window.onload = function () {
		var url = window.location.toString()
		selectorvalue = $('#languageselector').val()

		if (url.includes('/fr/')) {
			if (selectorvalue != 'fr') {
				$('#languageselector').val("fr")
			}
		} else if (url.includes('/en/')) {
			if (selectorvalue != 'en') {
				$('#languageselector').val("en")
			}
		} else if (url.includes('/dev/')) {
			if (selectorvalue != 'dev') {
				$('#languageselector').val("dev")
			}
		}

	};

	function testSelectOK() {
		var url = window.location.toString()
		selectorvalue = $('#languageselector').val()

		if (url.includes('/fr/')) {
			if (selectorvalue != 'fr') {
				return false
			}
		} else if (url.includes('/en/')) {
			if (selectorvalue != 'en') {
				return false
			}
		} else if (url.includes('/dev/')) {
			if (selectorvalue != 'dev') {
				return false
			}
		}

		return true

	}


	function languageSelector() {

		if (testSelectOK()) {
			return
		}
		var value = $('#languageselector').val();
		var url = window.location.toString()
		var n = url.indexOf("build")
		finalurl = url.substring(0, n) + 'build/' + value + '/html/index.html'
		console.log(finalurl)
		window.location = finalurl

	}
</script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #004F83" >
          


          
            <a href="../../../../../index.html" class="icon icon-home" alt="Documentation Home"> LAMIA
          

          
            
            <img src="../../../../../_static/icon.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          

<select id='languageselector' style="width: 100% ;border-radius: 20px 20px 20px 20px;" onchange=languageSelector()>
	<option value="fr">Documentation utilisateur fran√ßais</option>
	<option value="en">English user documentation</option>
	<option value="dev">Documentation for developpers</option>
</select>

        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../00_introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../01_globalpresentation.html">Organization of Lamia modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-api">Lamia.api</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-api-dbasemanager">Lamia.api.dbasemanager</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-api-libs">Lamia.api.libs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-api-libslamia">Lamia.api.libslamia</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-arteliasite">Lamia.arteliasite</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-config">Lamia.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-doc">Lamia.doc</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-qgisiface">Lamia.qgisiface</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_globalpresentation.html#lamia-test">Lamia.test</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../01_dev_env_install.html">Development environment install</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#prerequites">Prerequites</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#download-lamia-repo">Download lamia repo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#configure-visual-studio-code">Configure Visual Studio Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#modify-the-files-within-lamia-devcontainer-repository">Modify the files within Lamia/.devcontainer repository</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../01_dev_env_install.html#dockerfile">Dockerfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../01_dev_env_install.html#devcontainer-json">devcontainer.json</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#launch-vcxsrv">Launch vcxsrv</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#launch-docker">Launch Docker</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_dev_env_install.html#open-the-lamia-folder-with-visual-studio-code">Open the Lamia folder with Visual Studio Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../01_firststeps.html">Warming up with Lamia API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_firststeps.html#define-qgis-path-settings">Define QGIS path settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_firststeps.html#creating-and-loading-a-new-dbase">Creating and loading a new DBASE</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_firststeps.html#display-the-lamia-gui-outside-qgis">Display the lamia gui outside qgis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_firststeps.html#get-a-particular-form-of-lamia-ouside-qgis-gui">Get a particular form of  Lamia ouside qgis gui</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../01_firststeps.html#play-with-api-in-lamia-lamialibs">Play with API in Lamia.lamialibs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../02_creatingdbase.html">Creating a database</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../02_creatingdbase.html#understanding-global-logic">Understanding global logic</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../02_creatingdbase.html#the-ods-file">The .ods file</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../02_creatingdbase.html#reserved-tablename">Reserved tablename</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../02_creatingdbase.html#reserved-column-name">Reserved column name</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../02_creatingdbase.html#the-crud-py-file">The _crud.py file</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../03_creatingnewform.html">Creating a new form</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../03_creatingnewform.html#the-minimal-form-abstracclass">The minimal form abstracclass</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../03_creatingnewform.html#the-class-variables">The class variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../03_creatingnewform.html#inserting-child-form">Inserting child form</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../03_creatingnewform.html#coding-particular-behaviours">Coding particular behaviours</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../05_00_API.html">API Documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../../src_api/05_01_dbasemanager.html">dbasemanager Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_01_dbasemanager_dbaseparserabstract.html">AbstractDBaseParser</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_01_dbasemanager_dbaseutils.html">dbaseutils</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_01_dbasemanager_dbconfigreader.html">DBconfigReader</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../../../src_api/05_02_iface.html">QGis interface widgets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html">LamiaWindowWidget</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_02_iface_lamia_abstracttool.html">AbstractLamiaTool</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../../src_api/05_02_iface_lamia_abstractformtool.html">AbstractLamiaFormTool</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../index.html">LAMIA</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../../../index.html">Code du module</a> &raquo;</li>
        
      <li>Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">

           <div itemprop="articleBody">
            
  <h1>Code source de Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">unicode_literals</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">This file is part of LAMIA.</span>

<span class="sd">    LAMIA is free software: you can redistribute it and/or modify</span>
<span class="sd">    it under the terms of the GNU General Public License as published by</span>
<span class="sd">    the Free Software Foundation, either version 3 of the License, or</span>
<span class="sd">    (at your option) any later version.</span>

<span class="sd">    LAMIA is distributed in the hope that it will be useful,</span>
<span class="sd">    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="sd">    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span class="sd">    GNU General Public License for more details.</span>

<span class="sd">    You should have received a copy of the GNU General Public License</span>
<span class="sd">    along with Foobar.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  * Copyright (c) 2017-2020 ARTELIA Commit &lt;lamia@arteliagroup.com&gt;</span>
<span class="sd">  * </span>
<span class="sd">  * SPDX-License-Identifier: GPL-3.0-or-later</span>
<span class="sd">  * License-Filename: LICENSING.md</span>
<span class="sd"> &quot;&quot;&quot;</span>
<span class="c1"># qgis pyqt import</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt</span> <span class="kn">import</span> <span class="n">QtGui</span><span class="p">,</span> <span class="n">uic</span><span class="p">,</span> <span class="n">QtCore</span>
<span class="kn">from</span> <span class="nn">unicodedata</span> <span class="kn">import</span> <span class="n">normalize</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtCore</span> <span class="kn">import</span> <span class="n">pyqtSignal</span><span class="p">,</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">qgis.PyQt.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">QDockWidget</span><span class="p">,</span>
    <span class="n">QMainWindow</span><span class="p">,</span>
    <span class="n">QFileDialog</span><span class="p">,</span>
    <span class="n">QLabel</span><span class="p">,</span>
    <span class="n">QInputDialog</span><span class="p">,</span>
    <span class="n">QComboBox</span><span class="p">,</span>
    <span class="n">QTableWidgetItem</span><span class="p">,</span>
    <span class="n">QProgressBar</span><span class="p">,</span>
    <span class="n">QApplication</span><span class="p">,</span>
    <span class="n">QToolBar</span><span class="p">,</span>
    <span class="n">QPushButton</span><span class="p">,</span>
    <span class="n">QToolButton</span><span class="p">,</span>
    <span class="n">QWidget</span><span class="p">,</span>
    <span class="n">QMessageBox</span><span class="p">,</span>
    <span class="n">QAction</span><span class="p">,</span>
    <span class="n">QFrame</span><span class="p">,</span>
<span class="p">)</span>


<span class="c1"># other libs import</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">qgis</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">subprocess</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>


<span class="kn">import</span> <span class="nn">glob</span><span class="o">,</span> <span class="nn">importlib</span><span class="o">,</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>

<span class="kn">import</span> <span class="nn">Lamia</span><span class="o">,</span> <span class="nn">Lamia.qgisiface</span><span class="o">,</span> <span class="nn">Lamia.config</span><span class="o">,</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">Lamia.api.libslamia.gps.GPSutil</span> <span class="kn">import</span> <span class="n">GpsUtil</span>
<span class="kn">from</span> <span class="nn">Lamia.api.dbasemanager.dbaseparserfactory</span> <span class="kn">import</span> <span class="n">DBaseParserFactory</span>

<span class="kn">from</span> <span class="nn">..ifaceabstractwidget</span> <span class="kn">import</span> <span class="n">LamiaIFaceAbstractWidget</span>
<span class="kn">from</span> <span class="nn">..qgsconnector.ifaceqgisconnector</span> <span class="kn">import</span> <span class="n">QgisConnector</span>
<span class="kn">from</span> <span class="nn">..qgscanvas.ifaceqgiscanvas</span> <span class="kn">import</span> <span class="n">QgisCanvas</span>

<span class="kn">from</span> <span class="nn">.subdialogs.lamia_Connexion_PG</span> <span class="kn">import</span> <span class="n">ConnexionPGDialog</span>
<span class="kn">from</span> <span class="nn">.subdialogs.lamia_ConflitHorsLigne</span> <span class="kn">import</span> <span class="n">ConflitHorsLigne</span>
<span class="kn">from</span> <span class="nn">.subdialogs.lamia_iconsize</span> <span class="kn">import</span> <span class="n">IconSizeDialog</span>
<span class="kn">from</span> <span class="nn">.subdialogs.lamia_newDB</span> <span class="kn">import</span> <span class="n">newDBDialog</span>
<span class="kn">from</span> <span class="nn">.subdialogs.lamia_getDate</span> <span class="kn">import</span> <span class="n">getDateDialog</span>
<span class="kn">from</span> <span class="nn">.subdialogs.lamia_tablefield_dialog</span> <span class="kn">import</span> <span class="n">LamiaTableFieldDialog</span>


<span class="c1"># version 01</span>


<span class="n">debugtime</span> <span class="o">=</span> <span class="kc">False</span>


<div class="viewcode-block" id="LamiaWindowWidget"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget">[docs]</a><span class="k">class</span> <span class="nc">LamiaWindowWidget</span><span class="p">(</span><span class="n">QMainWindow</span><span class="p">,</span> <span class="n">LamiaIFaceAbstractWidget</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    the main window widget</span>

<span class="sd">    ******************      self           ************************</span>
<span class="sd">    ***************************************************************</span>
<span class="sd">    *                      toolbarForm                            *</span>
<span class="sd">    ***************************************************************</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    * tool      *                                                 *</span>
<span class="sd">    * treewidget*           tools                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    *************                                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    * chooser   *                                                 *</span>
<span class="sd">    * treewidget*                                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    *           *                                                 *</span>
<span class="sd">    ***************************************************************</span>
<span class="sd">    ***************************************************************</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">closingPlugin</span> <span class="o">=</span> <span class="n">pyqtSignal</span><span class="p">()</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">canvas</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dockwgt</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Constructor</span>
<span class="sd">        :param canvas : current qgsmapcanvas</span>
<span class="sd">        :param parent : pyqt widget parent</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># super(LamiaWindowWidget, self).__init__(parent)</span>
        <span class="c1"># super(LamiaWindowWidget, self).__init__(parent)</span>
        <span class="n">LamiaIFaceAbstractWidget</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">QMainWindow</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">)</span>
        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;ifaceqgswidget.ui&quot;</span><span class="p">)</span>
        <span class="n">uic</span><span class="o">.</span><span class="n">loadUi</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>

        <span class="c1"># connector and canvas</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span> <span class="o">=</span> <span class="n">QgisConnector</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">widget</span> <span class="o">=</span> <span class="bp">self</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span> <span class="o">=</span> <span class="n">QgisCanvas</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span> <span class="o">=</span> <span class="n">GpsUtil</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">hauteurperche</span> <span class="o">=</span> <span class="mf">2.0</span>

        <span class="c1"># statusbar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;GPS not connected&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;GPS rod height : /&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statusBar</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="p">)</span>

        <span class="c1"># interfacemode</span>
        <span class="c1"># old :self.dbase.visualmode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dict containing all tools classes (prepro / postpro)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dict containing all tools widgets (prepro / postpro)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span>
            <span class="s2">&quot;desktop_loaded&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># used to store desktoptools are arlready loaded</span>

        <span class="c1"># behaviour var</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagedirectory</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="c1"># store qgis tool bar visibility when entering/exiting field mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># subdialogs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDBDialog</span> <span class="o">=</span> <span class="n">newDBDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crsselector</span> <span class="o">=</span> <span class="n">qgis</span><span class="o">.</span><span class="n">gui</span><span class="o">.</span><span class="n">QgsProjectionSelectionDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span> <span class="o">=</span> <span class="n">QFileDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connPGDialog</span> <span class="o">=</span> <span class="n">ConnexionPGDialog</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablefielddialog</span> <span class="o">=</span> <span class="n">LamiaTableFieldDialog</span><span class="p">()</span>

        <span class="c1"># camera path</span>
        <span class="k">if</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;Lamia/picturepath&quot;</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imagedirectory</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span>
                <span class="n">QtCore</span><span class="o">.</span><span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">value</span><span class="p">(</span><span class="s2">&quot;Lamia/picturepath&quot;</span><span class="p">)</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imagedirectory</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># ************** Init actions ******************</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_manageQgisDockWidgetOnStart</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connectMenuAndOthers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_connectToolBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_readRecentDBase</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateRecentDBaseMenu</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">splitter_2</span><span class="o">.</span><span class="n">setSizes</span><span class="p">([</span><span class="mi">80</span><span class="p">,</span> <span class="mi">200</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;end&quot;</span><span class="p">)</span>

        <span class="c1"># ******* dev actions</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hideDevQWidgets</span><span class="p">()</span>

    <span class="c1"># ***********************************************************</span>
    <span class="c1"># **************** File menu actions ***********************</span>
    <span class="c1"># ***********************************************************</span>

    <span class="k">def</span> <span class="nf">____________FileMenuActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_dialogForDbaseConf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;spatialite&quot;</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;spatialite&quot;</span><span class="p">:</span>
            <span class="c1"># spatialitefile, fileext = self.qfiledlg.getSaveFileName(</span>
            <span class="c1">#     self, self.tr(&quot;Lamia new&quot;), &quot;&quot;, &quot;*.sqlite&quot;</span>
            <span class="c1"># )</span>

            <span class="n">spatialitefile</span><span class="p">,</span> <span class="n">fileext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
                <span class="kc">None</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Lamia new&quot;</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;Spatialite (*.sqlite)&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="p">)</span>

            <span class="k">return</span> <span class="p">{</span><span class="s2">&quot;slfile&quot;</span><span class="p">:</span> <span class="n">spatialitefile</span><span class="p">}</span>
        <span class="k">elif</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;postgis&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connDialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="p">(</span>
                <span class="n">adresse</span><span class="p">,</span>
                <span class="n">port</span><span class="p">,</span>
                <span class="n">nom</span><span class="p">,</span>
                <span class="n">schema</span><span class="p">,</span>
                <span class="n">user</span><span class="p">,</span>
                <span class="n">password</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connDialog</span><span class="o">.</span><span class="n">dialogIsFinished</span><span class="p">()</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="s2">&quot;host&quot;</span><span class="p">:</span> <span class="n">adresse</span><span class="p">,</span>
                <span class="s2">&quot;port&quot;</span><span class="p">:</span> <span class="n">port</span><span class="p">,</span>
                <span class="s2">&quot;dbname&quot;</span><span class="p">:</span> <span class="n">nom</span><span class="p">,</span>
                <span class="s2">&quot;schema&quot;</span><span class="p">:</span> <span class="n">schema</span><span class="p">,</span>
                <span class="s2">&quot;user&quot;</span><span class="p">:</span> <span class="n">user</span><span class="p">,</span>
                <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">password</span><span class="p">,</span>
            <span class="p">}</span>

<div class="viewcode-block" id="LamiaWindowWidget.newDBase"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.newDBase">[docs]</a>    <span class="k">def</span> <span class="nf">newDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        pass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># dialog with dbtype, worktype, vartype  chooser</span>
        <span class="c1"># self.newDBDialog.comboBox_type.currentIndexChanged.emit(0)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">newDBDialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="n">dbtype</span><span class="p">,</span> <span class="n">worktype</span><span class="p">,</span> <span class="n">vartype</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">newDBDialog</span><span class="o">.</span><span class="n">dialogIsFinished</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">dbtype</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="c1"># dialog for crs selector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crsselector</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
        <span class="n">crs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crsselector</span><span class="o">.</span><span class="n">crs</span><span class="p">()</span><span class="o">.</span><span class="n">authid</span><span class="p">()</span>
        <span class="n">crsnumber</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">crs</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>

        <span class="c1"># dialog for ressources directory</span>
        <span class="k">if</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;postgis&quot;</span><span class="p">:</span>
            <span class="n">resdir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Select resources directory&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">resdir</span><span class="p">:</span>
                <span class="n">resdir</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">resdir</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">resdir</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># dialogs finished - reinit base TODO</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        self.dbase.reInitDBase()</span>
<span class="sd">        reset dbase</span>
<span class="sd">        self.createDBase() </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># dialog for dbase spec</span>
        <span class="k">if</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;spatialite&quot;</span><span class="p">:</span>
            <span class="n">spatialitefile</span><span class="p">,</span> <span class="n">fileext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span><span class="o">.</span><span class="n">getSaveFileName</span><span class="p">(</span>
                <span class="bp">self</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Lamia new&quot;</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;*.sqlite&quot;</span>
            <span class="p">)</span>
            <span class="c1"># self.createDBase() TODO</span>
            <span class="k">if</span> <span class="n">spatialitefile</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot; Database creation...&quot;</span><span class="p">))</span>

                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span> <span class="o">=</span> <span class="n">DBaseParserFactory</span><span class="p">(</span>
                    <span class="s2">&quot;spatialite&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span>
                <span class="p">)</span><span class="o">.</span><span class="n">getDbaseParser</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">createDBase</span><span class="p">(</span>
                    <span class="n">crs</span><span class="o">=</span><span class="n">crsnumber</span><span class="p">,</span>
                    <span class="n">worktype</span><span class="o">=</span><span class="n">worktype</span><span class="p">,</span>
                    <span class="n">dbaseressourcesdirectory</span><span class="o">=</span><span class="n">resdir</span><span class="p">,</span>
                    <span class="n">variante</span><span class="o">=</span><span class="n">vartype</span><span class="p">,</span>
                    <span class="n">slfile</span><span class="o">=</span><span class="n">spatialitefile</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span><span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Spatialite&quot;</span><span class="p">,</span> <span class="n">slfile</span><span class="o">=</span><span class="n">spatialitefile</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;postgis&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connPGDialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
            <span class="p">(</span>
                <span class="n">adresse</span><span class="p">,</span>
                <span class="n">port</span><span class="p">,</span>
                <span class="n">nom</span><span class="p">,</span>
                <span class="n">schema</span><span class="p">,</span>
                <span class="n">user</span><span class="p">,</span>
                <span class="n">password</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connPGDialog</span><span class="o">.</span><span class="n">dialogIsFinished</span><span class="p">()</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">adresse</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">nom</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="ow">and</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
            <span class="p">):</span>
                <span class="c1"># self.createDBase()</span>
                <span class="n">databaseexists</span><span class="p">,</span> <span class="n">schemaexists</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">checkIfPGShcemaExists</span><span class="p">(</span>
                    <span class="n">host</span><span class="o">=</span><span class="n">adresse</span><span class="p">,</span>
                    <span class="n">dbname</span><span class="o">=</span><span class="n">nom</span><span class="p">,</span>
                    <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                    <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                    <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="n">schemaexists</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;schema existe deja - choisir un autre schema&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot; Database creation...&quot;</span><span class="p">)</span>
                        <span class="p">)</span>
                    <span class="c1"># reset dbase</span>
                    <span class="c1"># self.createDBase()</span>
                    <span class="c1"># QApplication.processEvents()</span>

                    <span class="c1"># resdir = self.createRessourcesDir(dbtype, resdir,vardir=vardir)</span>

                    <span class="c1"># self.dbase.createDbase(crs=crsnumber, worktype=worktype, dbasetype=&#39;postgis&#39;, dbname=nom, schema=schema,</span>
                    <span class="c1">#                       user=user, host=adresse, password=password, dbaseressourcesdirectory=resdir,</span>
                    <span class="c1">#                       port=port,variante=vartype)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span> <span class="o">=</span> <span class="n">DBaseParserFactory</span><span class="p">(</span>
                        <span class="s2">&quot;postgis&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">getDbaseParser</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">createDBase</span><span class="p">(</span>
                        <span class="n">crs</span><span class="o">=</span><span class="n">crsnumber</span><span class="p">,</span>
                        <span class="n">worktype</span><span class="o">=</span><span class="n">worktype</span><span class="p">,</span>
                        <span class="n">dbaseressourcesdirectory</span><span class="o">=</span><span class="n">resdir</span><span class="p">,</span>
                        <span class="n">variante</span><span class="o">=</span><span class="n">vartype</span><span class="p">,</span>
                        <span class="n">host</span><span class="o">=</span><span class="n">adresse</span><span class="p">,</span>
                        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                        <span class="n">dbname</span><span class="o">=</span><span class="n">nom</span><span class="p">,</span>
                        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                        <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                    <span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span>
                        <span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Postgis&quot;</span><span class="p">,</span>
                        <span class="n">host</span><span class="o">=</span><span class="n">adresse</span><span class="p">,</span>
                        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                        <span class="n">dbname</span><span class="o">=</span><span class="n">nom</span><span class="p">,</span>
                        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                        <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                    <span class="p">)</span></div>

<div class="viewcode-block" id="LamiaWindowWidget.loadDBase"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.loadDBase">[docs]</a>    <span class="k">def</span> <span class="nf">loadDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;[summary]</span>
<span class="sd">        kwargs contains either var:</span>
<span class="sd">        - dbtype : &#39;Postgis&#39; or &#39;Spatialite&#39;</span>
<span class="sd">        - slfile (optionnal)</span>
<span class="sd">        - host port dbname schema userpassword (optionnal)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reinitWidgetbeforeloading</span><span class="p">()</span>

        <span class="k">if</span> <span class="s2">&quot;dbtype&quot;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>  <span class="c1"># case come from qt event</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s2">&quot;dbtype&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">objectName</span><span class="p">()[</span><span class="mi">6</span><span class="p">:]</span>
        <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_loadDBaseParser</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">success</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="c1"># self.connector.showNormalMessage(self.tr(&#39;Loading Layers ...&#39;))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Loading Layers ...&quot;</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadVectorLayers</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_loadStyles</span><span class="p">()</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">closeProgressBar</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_AddDbaseInRecentsDBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsClasses</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsWidgets</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="s2">&quot;Lamia UI loading ...&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setVisualMode</span><span class="p">(</span><span class="n">visualmode</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">updateWorkingDate</span><span class="p">(</span><span class="n">dbaseparser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">)</span>
        <span class="c1"># self.connector.closeProgressBar()</span>
        <span class="c1"># offline behaviour</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSynchronize_DB</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">_checkIfLocalDB</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_pulldb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span>
            <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">_checkIfLocalDB</span><span class="p">()</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">():</span>
            <span class="n">wintitle</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot; Lamia : {self.dbase.getDBName()} - type : </span><span class="si">{self.dbase.TYPE}</span><span class="s2">&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="n">wintitle</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="s2">&quot;Lamia loaded&quot;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="nf">reinitWidgetbeforeloading</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># old :self.dbase.visualmode</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dict containing all tools classes (prepro / postpro)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dict containing all tools widgets (prepro / postpro)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span>
            <span class="s2">&quot;desktop_loaded&quot;</span>
        <span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># used to store desktoptools are arlready loaded</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">MaintreeWidget</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MaintreeWidget</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaintreeWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="c1"># behaviour var</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="o">.</span><span class="n">disconnectTreewidget</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">choosertreewidget</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">choosertreewidget</span><span class="o">.</span><span class="n">disconnectTreewidget</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">setParent</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">closeConnection</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">disconnect</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">createorresetRubberband</span><span class="p">(</span><span class="n">rubtype</span><span class="o">=</span><span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">unloadLayersInCanvas</span><span class="p">()</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="p">()</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Lamia&quot;</span><span class="p">)</span>

        <span class="n">QApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">SynchronizeDB</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">offlineslpath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">connectconf</span><span class="p">[</span><span class="s2">&quot;slfile&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">SynchronizeDB</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opening offline synchronized dbase ... &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">stopdisplaymessage</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span><span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Spatialite&quot;</span><span class="p">,</span> <span class="n">slfile</span><span class="o">=</span><span class="n">offlineslpath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">stopdisplaymessage</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Offline dbase synchronized&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">closeProject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reinitWidgetbeforeloading</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">pullDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exportfilepath</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># for offline mode</span>

        <span class="n">exportfilepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">pullDBase</span><span class="p">(</span><span class="n">exportfilepath</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">exportfilepath</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Opening offline copy ... &quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">stopdisplaymessage</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span><span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Spatialite&quot;</span><span class="p">,</span> <span class="n">slfile</span><span class="o">=</span><span class="n">exportfilepath</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">stopdisplaymessage</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">messageinstance</span><span class="o">.</span><span class="n">showNormalMessage</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Offline copy loaded&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">pushDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>  <span class="c1"># for offline mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">pushDBase</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">dbconf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dialogForDbaseConf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseofflinemanager</span><span class="o">.</span><span class="n">addDBase</span><span class="p">(</span><span class="o">**</span><span class="n">dbconf</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_loadDBaseParser</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">success</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="s2">&quot;dbtype&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
            <span class="n">dbtype</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dbtype&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;Postgis&quot;</span><span class="p">:</span>
                <span class="n">neededkwargs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span>
                    <span class="p">[</span><span class="s2">&quot;host&quot;</span><span class="p">,</span> <span class="s2">&quot;port&quot;</span><span class="p">,</span> <span class="s2">&quot;dbname&quot;</span><span class="p">,</span> <span class="s2">&quot;schema&quot;</span><span class="p">,</span> <span class="s2">&quot;user&quot;</span><span class="p">,</span> <span class="s2">&quot;password&quot;</span><span class="p">]</span>
                <span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">neededkwargs</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">()))):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">connDialog</span> <span class="o">=</span> <span class="n">ConnexionPGDialog</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">connDialog</span><span class="o">.</span><span class="n">exec_</span><span class="p">()</span>
                    <span class="p">(</span>
                        <span class="n">host</span><span class="p">,</span>
                        <span class="n">port</span><span class="p">,</span>
                        <span class="n">dbname</span><span class="p">,</span>
                        <span class="n">schema</span><span class="p">,</span>
                        <span class="n">user</span><span class="p">,</span>
                        <span class="n">password</span><span class="p">,</span>
                    <span class="p">)</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">connDialog</span><span class="o">.</span><span class="n">dialogIsFinished</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">dbname</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="p">(</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;host&quot;</span><span class="p">),</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;port&quot;</span><span class="p">),</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;dbname&quot;</span><span class="p">),</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;schema&quot;</span><span class="p">),</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;user&quot;</span><span class="p">),</span>
                        <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;password&quot;</span><span class="p">),</span>
                    <span class="p">)</span>

                <span class="k">if</span> <span class="p">(</span>
                    <span class="n">host</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">port</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">dbname</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">user</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="ow">and</span> <span class="n">password</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                <span class="p">):</span>
                    <span class="c1"># reset dbase</span>
                    <span class="c1"># self.createDBase()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span> <span class="o">=</span> <span class="n">DBaseParserFactory</span><span class="p">(</span>
                        <span class="s2">&quot;postgis&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">getDbaseParser</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span>
                        <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
                        <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                        <span class="n">dbname</span><span class="o">=</span><span class="n">dbname</span><span class="p">,</span>
                        <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                        <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                        <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                    <span class="p">)</span>

                    <span class="c1"># self.dbase.loadQgisVectorLayers(file=None, dbasetype=&#39;postgis&#39;, host=adresse, port=port, dbname=nom,</span>
                    <span class="c1">#                                schema=schema, user=user, password=password)</span>
                    <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">elif</span> <span class="n">dbtype</span> <span class="o">==</span> <span class="s2">&quot;Spatialite&quot;</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="s2">&quot;slfile&quot;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">slfile</span><span class="p">,</span> <span class="n">extension</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span><span class="o">.</span><span class="n">getOpenFileName</span><span class="p">(</span>
                        <span class="kc">None</span><span class="p">,</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Choose the file&quot;</span><span class="p">),</span>
                        <span class="s2">&quot;&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;Spatialite (*.sqlite)&quot;</span><span class="p">,</span>
                        <span class="s2">&quot;&quot;</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">slfile</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;slfile&quot;</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">slfile</span><span class="p">:</span>
                    <span class="c1"># reset dbase</span>
                    <span class="c1"># self.reinitDBase()</span>
                    <span class="c1"># reset dbase</span>
                    <span class="c1"># self.createDBase()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span> <span class="o">=</span> <span class="n">DBaseParserFactory</span><span class="p">(</span>
                        <span class="s2">&quot;spatialite&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">connector</span>
                    <span class="p">)</span><span class="o">.</span><span class="n">getDbaseParser</span><span class="p">()</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span><span class="n">slfile</span><span class="o">=</span><span class="n">slfile</span><span class="p">)</span>
                    <span class="c1"># self.dbase.loadQgisVectorLayers(file)</span>
                    <span class="n">success</span> <span class="o">=</span> <span class="kc">True</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="k">return</span> <span class="n">success</span>

    <span class="k">def</span> <span class="nf">_loadVectorLayers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">createLayers</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">loadLayersInCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_updateRecentDBaseMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menuBases_recentes</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_openFileFromMenu</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBases_recentes</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">telem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menuBases_recentes</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">telem</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuBases_recentes</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_openFileFromMenu</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_readRecentDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Lit le fichier des bases de donn√©es recentes et rempli le  menu//Fichier//base de donn√©es recentes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pathrecentproject</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">Lamia</span><span class="o">.</span><span class="n">qgisiface</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;recentprojects.txt&quot;</span>
        <span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pathrecentproject</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">lines</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">lines</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
                <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">())</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># self.recentDBaseChanged.emit()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateRecentDBaseMenu</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_AddDbaseInRecentsDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbaseparser</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Methode appel√©e lors du chargement d&#39;une BD lamia</span>
<span class="sd">        Ajoute le chemin dans le fichier charg√© dans Menu//Fichier//base de donn√©es recentes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># if self.dbase.dbasetype == &#39;spatialite&#39;:</span>
        <span class="k">if</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;SpatialiteDBaseParser&quot;</span><span class="p">:</span>
            <span class="n">spatialitefile</span> <span class="o">=</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="n">spatialitefile</span>
            <span class="k">if</span> <span class="n">spatialitefile</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">spatialitefile</span><span class="p">)</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">spatialitefile</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_saveRecentDBase</span><span class="p">()</span>
            <span class="c1"># self.recentDBaseChanged.emit()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updateRecentDBaseMenu</span><span class="p">()</span>
        <span class="c1"># elif self.dbase.dbasetype == &#39;postgis&#39;:</span>
        <span class="k">elif</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="vm">__class__</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;PostGisDBaseParser&quot;</span><span class="p">:</span>
            <span class="c1"># name = dbname + &#39;.&#39; +schema  + &#39;@&#39; + host + &#39;:&#39; + str(port) + &#39;;&#39; + user + &#39;;&#39; + password</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="n">pgdb</span> <span class="o">+</span> <span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="n">pgschema</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="s2">&quot;@&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dbaseparser</span><span class="o">.</span><span class="n">pghost</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;:&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">dbaseparser</span><span class="o">.</span><span class="n">pgport</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span>
            <span class="n">name</span> <span class="o">+=</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="n">pguser</span> <span class="o">+</span> <span class="s2">&quot;;&quot;</span> <span class="o">+</span> <span class="n">dbaseparser</span><span class="o">.</span><span class="n">pgpassword</span>
            <span class="k">if</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">:</span>
                <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_saveRecentDBase</span><span class="p">()</span>
            <span class="c1"># self.recentDBaseChanged.emit()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_updateRecentDBaseMenu</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_saveRecentDBase</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sauve le path de la BD lamia en cours d&#39;utilisation dans le ficier employ√© dans</span>
<span class="sd">        menu//Fichier//base de donn√©es recentes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pathrecentproject</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">Lamia</span><span class="o">.</span><span class="n">qgisiface</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="s2">&quot;recentprojects.txt&quot;</span>
        <span class="p">)</span>
        <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">pathrecentproject</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">path</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">recentsdbase</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">10</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">path</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
                <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_updateRecentDBaseMenu</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_openFileFromMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">action</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        pass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">filetoopen</span> <span class="o">=</span> <span class="n">action</span><span class="o">.</span><span class="n">text</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">filetoopen</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">))</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># self.createDBase()</span>
            <span class="c1"># self.dbase.loadQgisVectorLayers(filetoopen)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span><span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Spatialite&quot;</span><span class="p">,</span> <span class="n">slfile</span><span class="o">=</span><span class="n">filetoopen</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># self.createDBase()</span>
            <span class="n">db</span><span class="p">,</span> <span class="n">user</span><span class="p">,</span> <span class="n">password</span> <span class="o">=</span> <span class="n">filetoopen</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;;&quot;</span><span class="p">)</span>
            <span class="n">nom</span><span class="p">,</span> <span class="n">schema</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
            <span class="n">adresse</span><span class="p">,</span> <span class="n">port</span> <span class="o">=</span> <span class="n">db</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;@&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
            <span class="c1"># self.dbase.loadQgisVectorLayers(dbasetype=&#39;postgis&#39;, host=adresse, port=int(port), dbname=nom,</span>
            <span class="c1">#                                schema=schema, user=user, password=password)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">(</span>
                <span class="n">dbtype</span><span class="o">=</span><span class="s2">&quot;Postgis&quot;</span><span class="p">,</span>
                <span class="n">host</span><span class="o">=</span><span class="n">adresse</span><span class="p">,</span>
                <span class="n">port</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">port</span><span class="p">),</span>
                <span class="n">dbname</span><span class="o">=</span><span class="n">nom</span><span class="p">,</span>
                <span class="n">schema</span><span class="o">=</span><span class="n">schema</span><span class="p">,</span>
                <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span>
                <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_loadStyles</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboStyleChanged</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>

        <span class="n">stylepath</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">_getStyleDirectory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">worktype</span><span class="p">)</span>

        <span class="n">styledirs</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">stylepath</span><span class="p">)</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">styledirs</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">styledirs</span> <span class="o">=</span> <span class="n">styledirs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="n">styledirs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">comboStyleChanged</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">emit</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<div class="viewcode-block" id="LamiaWindowWidget.comboStyleChanged"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.comboStyleChanged">[docs]</a>    <span class="k">def</span> <span class="nf">comboStyleChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">comboindex</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Listener on style combobox changed</span>
<span class="sd">        :param comboindex:</span>
<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">styledir</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">comboBox_style</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="c1"># stylerep = os.path.join(os.path.dirname(Lamia.__file__), &#39;DBASE&#39;, &#39;style&#39;, self.dbase.worktype, styledir )</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">applyStyle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">worktype</span><span class="p">,</span> <span class="n">styledir</span><span class="p">)</span></div>

    <span class="c1"># ***********************************************************</span>
    <span class="c1"># **************** Interface mode actions ***********************</span>
    <span class="c1"># ***********************************************************</span>
    <span class="k">def</span> <span class="nf">____________InterfacemodeActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="c1"># def setVisualMode(self, tempres=None, reset=False):</span>
<div class="viewcode-block" id="LamiaWindowWidget.setVisualMode"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.setVisualMode">[docs]</a>    <span class="k">def</span> <span class="nf">setVisualMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        pass</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">visualmodedict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="mi">0</span><span class="p">:</span> <span class="s2">&quot;actionModeTerrain&quot;</span><span class="p">,</span>
            <span class="mi">1</span><span class="p">:</span> <span class="s2">&quot;actionTTC&quot;</span><span class="p">,</span>
            <span class="mi">2</span><span class="p">:</span> <span class="s2">&quot;actionModeExpert&quot;</span><span class="p">,</span>
            <span class="mi">4</span><span class="p">:</span> <span class="s2">&quot;actionPosttraitement&quot;</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="n">reset</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;reset&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="n">visualmode</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;visualmode&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">visualmode</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">actionname</span> <span class="o">=</span> <span class="n">visualmodedict</span><span class="p">[</span><span class="n">visualmode</span><span class="p">]</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">(),</span> <span class="n">QAction</span><span class="p">):</span>
            <span class="n">actionname</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">qactionchild</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuMode</span><span class="o">.</span><span class="n">actions</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">qact</span> <span class="ow">in</span> <span class="n">qactionchild</span><span class="p">:</span>
            <span class="n">qact</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">reset</span> <span class="ow">and</span> <span class="n">qact</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="n">actionname</span><span class="p">:</span>
                <span class="n">qact</span><span class="o">.</span><span class="n">setChecked</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">actionname</span> <span class="o">==</span> <span class="n">visualmodedict</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">elif</span> <span class="n">actionname</span> <span class="o">==</span> <span class="n">visualmodedict</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]:</span>
                <span class="c1"># self.loadUiDesktop()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsWidgets</span><span class="p">(</span><span class="n">fullloading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">actionname</span> <span class="o">==</span> <span class="n">visualmodedict</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">elif</span> <span class="n">actionname</span> <span class="o">==</span> <span class="n">visualmodedict</span><span class="p">[</span><span class="mi">4</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">interfacemode</span> <span class="o">=</span> <span class="mi">4</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]:</span>
                <span class="c1"># self.loadUiDesktop()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsWidgets</span><span class="p">(</span><span class="n">fullloading</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_applyVisualMode</span><span class="p">()</span></div>

    <span class="k">def</span> <span class="nf">_applyVisualMode</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actiontext</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">base3version</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">toolname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">toolname</span> <span class="o">==</span> <span class="s2">&quot;desktop_loaded&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="n">toolwdg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">toolname</span><span class="p">]</span>
                <span class="n">toolwdg</span><span class="o">.</span><span class="n">changeInterfaceMode</span><span class="p">()</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">tooltype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">tooltype</span> <span class="o">==</span> <span class="s2">&quot;desktop_loaded&quot;</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">toolname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">tooltype</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">toolwdg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">tooltype</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span>
                    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">toolwdg</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                        <span class="k">for</span> <span class="n">wdg</span> <span class="ow">in</span> <span class="n">toolwdg</span><span class="p">:</span>
                            <span class="c1"># tool dep</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">wdg</span><span class="p">,</span> <span class="s2">&quot;changeInterfaceMode&quot;</span><span class="p">):</span>
                                <span class="n">wdg</span><span class="o">.</span><span class="n">changeInterfaceMode</span><span class="p">()</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="n">wdg</span><span class="o">.</span><span class="n">changePropertiesWidget</span><span class="p">()</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># tool dep</span>
                        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toolwdg</span><span class="p">,</span> <span class="s2">&quot;changeInterfaceMode&quot;</span><span class="p">):</span>
                            <span class="n">toolwdg</span><span class="o">.</span><span class="n">changeInterfaceMode</span><span class="p">()</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">toolwdg</span><span class="o">.</span><span class="n">changePropertiesWidget</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">loadToolsClasses</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">base3version</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsClassesBase3</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsClassesBase2</span><span class="p">()</span>

<div class="viewcode-block" id="LamiaWindowWidget.loadToolsClassesBase2"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.loadToolsClassesBase2">[docs]</a>    <span class="k">def</span> <span class="nf">loadToolsClassesBase2</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load layers and put them in a legend group in qgis</span>
<span class="sd">        Load all modules (prepro, postpro and menu)</span>
<span class="sd">        Show field ui</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

        <span class="n">tooltypestoload</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;toolprepro&quot;</span><span class="p">,</span> <span class="s2">&quot;toolpostpro&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">tooltypetoload</span> <span class="ow">in</span> <span class="n">tooltypestoload</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

            <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">),</span>
                <span class="s2">&quot;tools&quot;</span><span class="p">,</span>
                <span class="n">tooltypetoload</span><span class="p">,</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">worktype</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="p">)</span>
            <span class="n">modules</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/*.py&quot;</span><span class="p">)</span>
            <span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">modules</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
            <span class="n">interfacefielduisup</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">__all__</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;x </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
                <span class="n">parentmodulename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="vm">__name__</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">modulename</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="n">parentmodulename</span>
                    <span class="o">+</span> <span class="s2">&quot;.tools.&quot;</span>
                    <span class="o">+</span> <span class="n">tooltypetoload</span>
                    <span class="o">+</span> <span class="s2">&quot;.&quot;</span>
                    <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">worktype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="p">)</span>
                <span class="n">exec</span><span class="p">(</span><span class="s2">&quot;import &quot;</span> <span class="o">+</span> <span class="n">modulename</span><span class="p">)</span>
                <span class="n">moduletemp</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="s2">&quot;.&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">modulename</span><span class="p">)</span>

                <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">moduletemp</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">moduletemp</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__module__</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">tooltypetoload</span> <span class="o">==</span> <span class="s2">&quot;toolpostpro&quot;</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;TOOLNAME&quot;</span><span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">][</span><span class="n">obj</span><span class="o">.</span><span class="n">TOOLNAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                        <span class="k">elif</span> <span class="p">(</span>
                            <span class="n">tooltypetoload</span> <span class="o">==</span> <span class="s2">&quot;toolpostpro&quot;</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;POSTPROTOOLNAME&quot;</span><span class="p">)</span>  <span class="c1"># dbase3</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;POSTPROTOOLNAME&quot;</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">POSTPROTOOLNAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">][</span><span class="n">obj</span><span class="o">.</span><span class="n">POSTPROTOOLNAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>

                        <span class="k">if</span> <span class="n">tooltypetoload</span> <span class="o">==</span> <span class="s2">&quot;toolprepro&quot;</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span>
                            <span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;dbasetablename&quot;</span>
                        <span class="p">):</span>  <span class="c1"># tool dep</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">][</span><span class="n">obj</span><span class="o">.</span><span class="n">dbasetablename</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                        <span class="k">elif</span> <span class="p">(</span>
                            <span class="n">tooltypetoload</span> <span class="o">==</span> <span class="s2">&quot;toolprepro&quot;</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;DBASETABLENAME&quot;</span><span class="p">)</span>  <span class="c1"># dbase3</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;PREPROTOOLNAME&quot;</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">PREPROTOOLNAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">][</span><span class="n">obj</span><span class="o">.</span><span class="n">PREPROTOOLNAME</span><span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>
                        <span class="k">elif</span> <span class="p">(</span>
                            <span class="n">tooltypetoload</span> <span class="o">==</span> <span class="s2">&quot;toolprepro&quot;</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;DBASETABLENAME&quot;</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;tooltreewidgetSUBCAT&quot;</span><span class="p">)</span>
                            <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">tooltreewidgetSUBCAT</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                        <span class="p">):</span>
                            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">tooltypetoload</span><span class="p">][</span>
                                <span class="n">obj</span><span class="o">.</span><span class="n">tooltreewidgetSUBCAT</span>
                            <span class="p">]</span> <span class="o">=</span> <span class="n">obj</span>

        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;x </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">))</span></div>

<div class="viewcode-block" id="LamiaWindowWidget.loadToolsClassesBase3"><a class="viewcode-back" href="../../../../../src_api/05_02_iface_ifaceqgswidget.html#Lamia.qgisiface.iface.qgiswidget.ifaceqgswidget.LamiaWindowWidget.loadToolsClassesBase3">[docs]</a>    <span class="k">def</span> <span class="nf">loadToolsClassesBase3</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Load layers and put them in a legend group in qgis</span>
<span class="sd">        Load all modules (prepro, postpro and menu)</span>
<span class="sd">        Show field ui</span>

<span class="sd">        :return:</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;start&quot;</span><span class="p">)</span>

        <span class="c1"># tooltypestoload = [&quot;toolprepro&quot;, &quot;toolpostpro&quot;]</span>

        <span class="n">modulelistpath</span> <span class="o">=</span> <span class="p">[</span>
            <span class="c1"># &quot;Lamia&quot;,</span>
            <span class="c1"># &quot;worktypeconf&quot;,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">worktype</span><span class="o">.</span><span class="n">lower</span><span class="p">(),</span>
            <span class="s2">&quot;qgswidgets&quot;</span><span class="p">,</span>
        <span class="p">]</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
            <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">Lamia</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span> <span class="s2">&quot;//&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">modulelistpath</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="n">pyfilespath</span> <span class="o">=</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="n">path</span> <span class="o">+</span> <span class="s2">&quot;/*.py&quot;</span><span class="p">)</span>
        <span class="n">pyfiles</span> <span class="o">=</span> <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">f</span><span class="p">)[:</span><span class="o">-</span><span class="mi">3</span><span class="p">]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">pyfilespath</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">)]</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">pyfiles</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;x </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
            <span class="n">classlistpath</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Lamia.config&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="n">modulelistpath</span> <span class="o">+</span> <span class="p">[</span><span class="n">x</span><span class="p">]</span>
            <span class="n">modulename</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">classlistpath</span><span class="p">)</span>
            <span class="n">moduletemp</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">modulename</span><span class="p">)</span>

            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">obj</span> <span class="ow">in</span> <span class="n">inspect</span><span class="o">.</span><span class="n">getmembers</span><span class="p">(</span><span class="n">moduletemp</span><span class="p">,</span> <span class="n">inspect</span><span class="o">.</span><span class="n">isclass</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">moduletemp</span><span class="o">.</span><span class="vm">__name__</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="vm">__module__</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;POSTPROTOOLNAME&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">POSTPROTOOLNAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">POSTPROTOOLNAME</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;postpro&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;loaded&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="s2">&quot;loadfirst&quot;</span><span class="p">:</span> <span class="kc">True</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;LOADFIRST&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">LOADFIRST</span>
                            <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="p">}</span>
                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;PREPROTOOLNAME&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">PREPROTOOLNAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">PREPROTOOLNAME</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                            <span class="s2">&quot;class&quot;</span><span class="p">:</span> <span class="n">obj</span><span class="p">,</span>
                            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;prepro&quot;</span><span class="p">,</span>
                            <span class="s2">&quot;loaded&quot;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
                            <span class="s2">&quot;loadfirst&quot;</span><span class="p">:</span> <span class="kc">True</span>
                            <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="s2">&quot;LOADFIRST&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">obj</span><span class="o">.</span><span class="n">LOADFIRST</span>
                            <span class="k">else</span> <span class="kc">False</span><span class="p">,</span>
                        <span class="p">}</span></div>

    <span class="k">def</span> <span class="nf">loadToolsWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullloading</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">base3version</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsWidgetsBase3</span><span class="p">(</span><span class="n">fullloading</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">loadToolsWidgetsBase2</span><span class="p">(</span><span class="n">fullloading</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">loadToolsWidgetsBase2</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullloading</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">typeswdg</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;toolprepro&quot;</span><span class="p">,</span> <span class="s2">&quot;toolpostpro&quot;</span><span class="p">]</span>

        <span class="n">toopreprodict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="s2">&quot;toolprepro&quot;</span><span class="p">]</span>
        <span class="n">lenprogresspartialloading</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">name</span>
                <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">toopreprodict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">toopreprodict</span><span class="p">[</span><span class="n">name</span><span class="p">],</span> <span class="s2">&quot;LOADFIRST&quot;</span><span class="p">)</span>
                <span class="ow">and</span> <span class="n">toopreprodict</span><span class="p">[</span><span class="n">name</span><span class="p">]</span><span class="o">.</span><span class="n">LOADFIRST</span>
            <span class="p">]</span>
        <span class="p">)</span>
        <span class="n">lenprogressfullloading</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="s2">&quot;toolprepro&quot;</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="s2">&quot;toolpostpro&quot;</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">creationstring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Loading widgets...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fullloading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span>
                <span class="n">creationstring</span><span class="p">,</span> <span class="n">lenprogressfullloading</span> <span class="o">-</span> <span class="n">lenprogresspartialloading</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span><span class="n">creationstring</span><span class="p">,</span> <span class="n">lenprogresspartialloading</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">typewdg</span> <span class="ow">in</span> <span class="n">typeswdg</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fullloading</span> <span class="ow">and</span> <span class="n">typewdg</span> <span class="o">==</span> <span class="s2">&quot;toolpostpro&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">typewdg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="k">for</span> <span class="n">toolname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">typewdg</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">toolname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                    <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;loading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">toolname</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">toolwdglist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span>
                <span class="n">toolwdgcls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="k">if</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">],</span> <span class="s2">&quot;PREPROTOOLNAME&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">fullloading</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span> <span class="o">=</span> <span class="n">toolwdgcls</span><span class="p">(</span>
                            <span class="n">dbaseparser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                            <span class="n">mainifacewidget</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">choosertreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                            <span class="n">parentwidget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">],</span> <span class="s2">&quot;POSTPROTOOLNAME&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="n">fullloading</span>
                    <span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">]</span> <span class="o">=</span> <span class="n">toolwdgcls</span><span class="p">(</span>
                            <span class="n">dbaseparser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                            <span class="n">mainifacewidget</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                            <span class="n">choosertreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                            <span class="n">parentwidget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                        <span class="p">)</span>

                    <span class="k">elif</span> <span class="p">(</span>
                        <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">[</span><span class="n">typewdg</span><span class="p">][</span><span class="n">toolname</span><span class="p">],</span> <span class="s2">&quot;LOADFIRST&quot;</span><span class="p">)</span>
                        <span class="ow">and</span> <span class="ow">not</span> <span class="n">fullloading</span>
                    <span class="p">):</span>
                        <span class="n">toolwdglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">toolwdgcls</span><span class="p">(</span>
                                <span class="n">dbase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                                <span class="n">dialog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">linkedtreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                                <span class="n">gpsutil</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="p">)</span>

                    <span class="k">else</span><span class="p">:</span>  <span class="c1"># tool dep</span>
                        <span class="n">toolwdglist</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                            <span class="n">toolwdgcls</span><span class="p">(</span>
                                <span class="n">dbase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                                <span class="n">dialog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                                <span class="n">linkedtreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                                <span class="n">gpsutil</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="p">,</span>
                            <span class="p">)</span>
                        <span class="p">)</span>

                <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="n">toolname</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
                    <span class="c1"># raise TypeError</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">updateProgressBar</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">fullloading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">closeProgressBar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">loadToolsWidgetsBase3</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullloading</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="n">lenprogresspartialloading</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="nb">list</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;loadfirst&quot;</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
                    <span class="k">if</span> <span class="n">elem</span><span class="p">[</span><span class="s2">&quot;loadfirst&quot;</span><span class="p">]</span>
                <span class="p">]</span>
            <span class="p">)</span>
        <span class="p">)</span>
        <span class="n">lenprogressfullloading</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="p">)</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        toopreprodict = self.wdgclasses[&quot;toolprepro&quot;]</span>
<span class="sd">        lenprogresspartialloading = len(</span>
<span class="sd">            [</span>
<span class="sd">                name</span>
<span class="sd">                for name in toopreprodict.keys()</span>
<span class="sd">                if hasattr(toopreprodict[name], &quot;LOADFIRST&quot;)</span>
<span class="sd">                and toopreprodict[name].LOADFIRST</span>
<span class="sd">            ]</span>
<span class="sd">        )</span>
<span class="sd">        lenprogressfullloading = len(self.wdgclasses[&quot;toolprepro&quot;]) + len(</span>
<span class="sd">            self.wdgclasses[&quot;toolpostpro&quot;]</span>
<span class="sd">        )</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># print(lenprogresspartialloading)</span>

        <span class="n">creationstring</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Loading widgets...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">fullloading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span>
                <span class="n">creationstring</span><span class="p">,</span> <span class="n">lenprogressfullloading</span> <span class="o">-</span> <span class="n">lenprogresspartialloading</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span><span class="n">creationstring</span><span class="p">,</span> <span class="n">lenprogresspartialloading</span><span class="p">)</span>

        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">wdgname</span><span class="p">,</span> <span class="n">wdgvalues</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">wdgclasses</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">fullloading</span> <span class="ow">and</span> <span class="n">wdgvalues</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;postpro&quot;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">wdgname</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="k">continue</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;loading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">wdgname</span><span class="p">)</span>

            <span class="k">if</span> <span class="p">(</span>
                <span class="n">wdgvalues</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;prepro&quot;</span>
                <span class="ow">and</span> <span class="n">wdgvalues</span><span class="p">[</span><span class="s2">&quot;loadfirst&quot;</span><span class="p">]</span>
                <span class="ow">and</span> <span class="ow">not</span> <span class="n">fullloading</span>
            <span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">wdgname</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdgvalues</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">](</span>
                    <span class="n">dbaseparser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                    <span class="n">mainifacewidget</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">choosertreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                    <span class="n">parentwidget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="n">wdgname</span><span class="p">]</span> <span class="o">=</span> <span class="n">wdgvalues</span><span class="p">[</span><span class="s2">&quot;class&quot;</span><span class="p">](</span>
                    <span class="n">dbaseparser</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                    <span class="n">mainifacewidget</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                    <span class="n">choosertreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                    <span class="n">parentwidget</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">updateProgressBar</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        for typewdg in typeswdg:</span>
<span class="sd">            if not fullloading and typewdg == &quot;toolpostpro&quot;:</span>
<span class="sd">                continue</span>
<span class="sd">            if not typewdg in self.toolwidgets.keys():</span>
<span class="sd">                self.toolwidgets[typewdg] = {}</span>
<span class="sd">            for toolname in self.wdgclasses[typewdg].keys():</span>
<span class="sd">                if toolname in self.toolwidgets[typewdg].keys():</span>
<span class="sd">                    continue</span>
<span class="sd">                if debug:</span>
<span class="sd">                    logging.getLogger(&quot;Lamia_unittest&quot;).debug(&quot;loading %s&quot;, toolname)</span>
<span class="sd">                self.toolwidgets[typewdg][toolname] = []</span>
<span class="sd">                toolwdglist = self.toolwidgets[typewdg][toolname]</span>
<span class="sd">                toolwdgcls = self.wdgclasses[typewdg][toolname]</span>
<span class="sd">                try:</span>
<span class="sd">                    if (</span>
<span class="sd">                        hasattr(self.wdgclasses[typewdg][toolname], &quot;PREPROTOOLNAME&quot;)</span>
<span class="sd">                        and not fullloading</span>
<span class="sd">                    ):</span>
<span class="sd">                        self.toolwidgets[typewdg][toolname] = toolwdgcls(</span>
<span class="sd">                            dbaseparser=self.dbase,</span>
<span class="sd">                            mainifacewidget=self,</span>
<span class="sd">                            choosertreewidget=self.ElemtreeWidget,</span>
<span class="sd">                            parentwidget=None,</span>
<span class="sd">                        )</span>

<span class="sd">                    elif (</span>
<span class="sd">                        hasattr(self.wdgclasses[typewdg][toolname], &quot;POSTPROTOOLNAME&quot;)</span>
<span class="sd">                        and fullloading</span>
<span class="sd">                    ):</span>
<span class="sd">                        self.toolwidgets[typewdg][toolname] = toolwdgcls(</span>
<span class="sd">                            dbaseparser=self.dbase,</span>
<span class="sd">                            mainifacewidget=self,</span>
<span class="sd">                            choosertreewidget=self.ElemtreeWidget,</span>
<span class="sd">                            parentwidget=None,</span>
<span class="sd">                        )</span>

<span class="sd">                    elif (</span>
<span class="sd">                        hasattr(self.wdgclasses[typewdg][toolname], &quot;LOADFIRST&quot;)</span>
<span class="sd">                        and not fullloading</span>
<span class="sd">                    ):</span>
<span class="sd">                        toolwdglist.append(</span>
<span class="sd">                            toolwdgcls(</span>
<span class="sd">                                dbase=self.dbase,</span>
<span class="sd">                                dialog=self,</span>
<span class="sd">                                linkedtreewidget=self.ElemtreeWidget,</span>
<span class="sd">                                gpsutil=self.gpsutil,</span>
<span class="sd">                            )</span>
<span class="sd">                        )</span>

<span class="sd">                    else:  # tool dep</span>
<span class="sd">                        toolwdglist.append(</span>
<span class="sd">                            toolwdgcls(</span>
<span class="sd">                                dbase=self.dbase,</span>
<span class="sd">                                dialog=self,</span>
<span class="sd">                                linkedtreewidget=self.ElemtreeWidget,</span>
<span class="sd">                                gpsutil=self.gpsutil,</span>
<span class="sd">                            )</span>
<span class="sd">                        )</span>

<span class="sd">                except TypeError as e:</span>
<span class="sd">                    print(toolname, e)</span>
<span class="sd">                    # raise TypeError</span>
<span class="sd">                i += 1</span>
<span class="sd">                self.connector.updateProgressBar(i)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">fullloading</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolwidgets</span><span class="p">[</span><span class="s2">&quot;desktop_loaded&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">closeProgressBar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">loadUiDesktop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fullloading</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="c1"># init progress bar</span>
        <span class="n">lenuifields</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uidesktop</span><span class="p">)</span>
        <span class="n">lenuipostpro</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">uipostpro</span><span class="p">)</span>
        <span class="n">lenmenutool</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">menuclasses</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connector</span><span class="o">.</span><span class="n">createProgressBar</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Loading widgets...&quot;</span><span class="p">),</span> <span class="n">lenuifields</span> <span class="o">+</span> <span class="n">lenuipostpro</span> <span class="o">+</span> <span class="n">lenmenutool</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">progressMessageBar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">createMessage</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Loading widgets...&quot;</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="n">QProgressBar</span><span class="p">()</span>
            <span class="n">progress</span><span class="o">.</span><span class="n">setAlignment</span><span class="p">(</span><span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignLeft</span> <span class="o">|</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">)</span>
            <span class="n">progressMessageBar</span><span class="o">.</span><span class="n">layout</span><span class="p">()</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">progress</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgisversion_int</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span> <span class="o">&lt;</span> <span class="mi">220</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushWidget</span><span class="p">(</span>
                    <span class="n">progressMessageBar</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">INFO</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">pushWidget</span><span class="p">(</span>
                    <span class="n">progressMessageBar</span><span class="p">,</span> <span class="n">qgis</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">Qgis</span><span class="o">.</span><span class="n">Info</span>
                <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">progress</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="c1"># load menu ui</span>
        <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">menuclasse</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">menuclasses</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menutools</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">menuclasse</span><span class="p">(</span><span class="n">dbase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span> <span class="n">windowdialog</span><span class="o">=</span><span class="bp">self</span><span class="p">))</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setLoadingProgressBar</span><span class="p">(</span><span class="n">progress</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot; loading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">menuclasse</span><span class="p">))</span>

        <span class="c1"># load postpro ui</span>
        <span class="k">for</span> <span class="n">uidpostpr</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uipostpro</span><span class="p">:</span>
            <span class="c1"># print(&#39;uidpostpr&#39;, uidpostpr)</span>
            <span class="n">strtoexec</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;self.&quot;</span>
                <span class="o">+</span> <span class="n">uidpostpr</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="o">+</span> <span class="s2">&quot; = uidpostpr(dbase = self.dbase, dialog = self,linkedtreewidget = self.ElemtreeWidget, gpsutil = self.gpsutil)&quot;</span>
            <span class="p">)</span>
            <span class="c1"># print(strtoexec)</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">strtoexec</span><span class="p">)</span>
            <span class="c1"># print(&#39;test&#39;, eval(&#39;self.&#39; + uidpostpr.__name__.lower()))</span>
            <span class="n">strtoexec</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;self.tools.append(&quot;</span> <span class="o">+</span> <span class="s2">&quot;self.&quot;</span> <span class="o">+</span> <span class="n">uidpostpr</span><span class="o">.</span><span class="vm">__name__</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="p">)</span>
            <span class="c1"># print(strtoexec)</span>
            <span class="n">exec</span><span class="p">(</span><span class="n">strtoexec</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot; loading </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">uidpostpr</span><span class="o">.</span><span class="vm">__name__</span><span class="p">))</span>
            <span class="c1"># print(&#39;ok&#39;)</span>

            <span class="k">if</span> <span class="kc">False</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tools</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">uidpostpr</span><span class="p">(</span>
                        <span class="n">dbase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                        <span class="n">dialog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">linkedtreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                        <span class="n">gpsutil</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
            <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">setLoadingProgressBar</span><span class="p">(</span><span class="n">progress</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

        <span class="c1"># load uidesktop ui</span>
        <span class="k">for</span> <span class="n">uidesktop</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">uidesktop</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">dbasename</span> <span class="o">=</span> <span class="n">uidesktop</span><span class="o">.</span><span class="n">dbasetablename</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbasetables</span><span class="p">[</span><span class="n">dbasename</span><span class="p">][</span><span class="s2">&quot;widget&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">uidesktop</span><span class="p">(</span>
                        <span class="n">dbase</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span>
                        <span class="n">dialog</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
                        <span class="n">linkedtreewidget</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ElemtreeWidget</span><span class="p">,</span>
                        <span class="n">gpsutil</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>
                <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">setLoadingProgressBar</span><span class="p">(</span><span class="n">progress</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">pass</span>

        <span class="k">if</span> <span class="n">progress</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">qgsiface</span><span class="o">.</span><span class="n">messageBar</span><span class="p">()</span><span class="o">.</span><span class="n">clearWidgets</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">desktopuiloaded</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># *************************************************************</span>
    <span class="c1"># Settings menu</span>
    <span class="c1"># *************************************************************</span>

    <span class="k">def</span> <span class="nf">____________SettingsMenuActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">connectToGPS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.actionHauteur_de_perche_GPS</span>
        <span class="c1"># ports = self.gpsutil.getAvailablePorts()</span>
        <span class="c1"># for portname, portid in ports:</span>
        <span class="c1">#     self.actionHauteur_de_perche_GPS.addAction(portname)</span>
        <span class="k">if</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">setCRS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">dbaseqgiscrs</span><span class="p">)</span>
            <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">connectToGPS</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">connectToPort</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuConnect_to_port</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="n">ports</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">getAvailablePorts</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">portname</span><span class="p">,</span> <span class="n">portid</span> <span class="ow">in</span> <span class="n">ports</span><span class="p">:</span>
            <span class="n">newAct</span> <span class="o">=</span> <span class="n">QAction</span><span class="p">(</span><span class="n">portname</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">menuConnect_to_port</span><span class="o">.</span><span class="n">addAction</span><span class="p">(</span><span class="n">newAct</span><span class="p">)</span>
            <span class="n">newAct</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">portClicked</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">portClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">setCRS</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">dbaseqgiscrs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">connectToPort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sender</span><span class="p">()</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">GPSconnected</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">success</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">success</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                <span class="s2">&quot;QLabel { background-color : rgb(85, 255, 0);  }&quot;</span>
            <span class="p">)</span>  <span class="c1"># vert</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;GPS connected&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Rod height : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">hauteurperche</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                <span class="s2">&quot;QLabel { background-color : rgb(85, 255, 0);  }&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QLabel { background-color : red;  }&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Accuracy : error&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">gstsentence</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayGPSPrecision</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomaddGPSpoint</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                <span class="s2">&quot;QLabel { background-color : rgba(0, 0, 0, 0);  }&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabel</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;GPS not connected&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Rod height : </span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelperchheigh</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                <span class="s2">&quot;QLabel { background-color : rgba(0, 0, 0, 0);  }&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                <span class="s2">&quot;QLabel { background-color : rgba(0, 0, 0, 0);  }&quot;</span>
            <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Accuracy : off&quot;</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomaddGPSpoint</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">gstsentence</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">displayGPSPrecision</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">displayGPSPrecision</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">gpsdict</span><span class="p">):</span>
        <span class="n">xprecision</span> <span class="o">=</span> <span class="n">gpsdict</span><span class="p">[</span><span class="s2">&quot;xprecision&quot;</span><span class="p">]</span>
        <span class="n">yprecision</span> <span class="o">=</span> <span class="n">gpsdict</span><span class="p">[</span><span class="s2">&quot;yprecision&quot;</span><span class="p">]</span>
        <span class="n">zprecision</span> <span class="o">=</span> <span class="n">gpsdict</span><span class="p">[</span><span class="s2">&quot;zprecision&quot;</span><span class="p">]</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">totalprecision</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span>
                <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">xprecision</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">yprecision</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">zprecision</span> <span class="o">**</span> <span class="mi">2</span><span class="p">),</span> <span class="mi">2</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">totalprecision</span> <span class="o">&lt;</span> <span class="mf">0.1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                    <span class="s2">&quot;QLabel { background-color : rgb(85, 255, 0);  }&quot;</span>
                <span class="p">)</span>  <span class="c1"># vert</span>
            <span class="k">elif</span> <span class="n">totalprecision</span> <span class="o">&lt;</span> <span class="mf">0.4</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                    <span class="s2">&quot;QLabel { background-color : yellow;  }&quot;</span>
                <span class="p">)</span>
            <span class="k">elif</span> <span class="n">totalprecision</span> <span class="o">&lt;</span> <span class="mf">1.5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                    <span class="s2">&quot;QLabel { background-color : rgb(255, 170, 0);  }&quot;</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span>
                    <span class="s2">&quot;QLabel { background-color : red;  }&quot;</span>
                <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Pr√©cision : &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">totalprecision</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot; m&quot;</span><span class="p">)</span>

        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setStyleSheet</span><span class="p">(</span><span class="s2">&quot;QLabel { background-color : red;  }&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">GPSlabelprecision</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Pr√©cision : erreur&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">setHauteurPerche</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">num</span><span class="p">,</span> <span class="n">ok</span> <span class="o">=</span> <span class="n">QInputDialog</span><span class="o">.</span><span class="n">getDouble</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Rod height&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Enter GPS rod height&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">hauteurperche</span><span class="p">,</span>
            <span class="n">decimals</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">ok</span><span class="p">:</span>
            <span class="c1"># self.dbase.hauteurperche = num</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">hauteurperche</span> <span class="o">=</span> <span class="n">num</span>

    <span class="k">def</span> <span class="nf">setImageDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">file</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qfiledlg</span><span class="o">.</span><span class="n">getExistingDirectory</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tr</span><span class="p">(</span><span class="s2">&quot;Select Directory&quot;</span><span class="p">),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">imagedirectory</span><span class="p">,</span>
            <span class="n">QFileDialog</span><span class="o">.</span><span class="n">ShowDirsOnly</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">file</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imagedirectory</span> <span class="o">=</span> <span class="n">file</span>
            <span class="n">QtCore</span><span class="o">.</span><span class="n">QSettings</span><span class="p">()</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="s2">&quot;Lamia/picturepath&quot;</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">openProjectDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="o">.</span><span class="n">dbaseressourcesdirectory</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;explorer &quot;{os.path.realpath(os.path.abspath(self.dbase.dbaseressourcesdirectory))}&quot;&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">openLamiaDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;explorer &quot;{os.path.realpath(os.path.dirname(Lamia.config.__file__))}&quot;&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">openOfflineDir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">Popen</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;explorer &quot;{os.path.realpath(self.dbase.dbaseofflinemanager.WINOFFLINEDIR)}&quot;&#39;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">showHideQgisToolbars</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_unloadQgisToolbar</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_reloadQgisToolbar</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_unloadQgisToolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QToolBar</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()]</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">isVisible</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span>
                <span class="s2">&quot;Lamia&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mFileToolBar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;mSnappingToolBar&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lamiatoolBarFormCreation&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lamiatoolBarFormGeom&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lamiatoolbareditlayer&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lamiatoolBartools&quot;</span><span class="p">,</span>
                <span class="s2">&quot;lamiatoolBarglobaltools&quot;</span><span class="p">,</span>
            <span class="p">]:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reloadQgisToolbar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span><span class="p">):</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QToolBar</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">x</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span><span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbarsvisibility</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">_manageQgisDockWidgetOnStart</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span><span class="o">.</span><span class="n">mainWindow</span><span class="p">()</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QDockWidget</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;GPSInformation&quot;</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">x</span><span class="o">.</span><span class="n">objectName</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;LayerStyling&quot;</span><span class="p">:</span>
                <span class="n">x</span><span class="o">.</span><span class="n">setVisible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

    <span class="c1"># *************************************************************</span>
    <span class="c1"># About menu</span>
    <span class="c1"># *************************************************************</span>

    <span class="k">def</span> <span class="nf">____________AboutMenuActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">openHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">httphelp</span> <span class="o">=</span> <span class="s2">&quot;https://artelia.github.io/Lamia/index.html&quot;</span>
            <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">httphelp</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">openSchema</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">sender</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;{self.sender().objectName()}&quot;</span>
            <span class="k">if</span> <span class="n">sender</span> <span class="o">==</span> <span class="s2">&quot;actionConceptual_model&quot;</span><span class="p">:</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">Lamia</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span>
                    <span class="s2">&quot;doc&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;schemas&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DBstructure-Relations.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">sender</span> <span class="o">==</span> <span class="s2">&quot;actionViews&quot;</span><span class="p">:</span>
                <span class="n">filepath</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
                    <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">Lamia</span><span class="o">.</span><span class="vm">__file__</span><span class="p">),</span>
                    <span class="s2">&quot;doc&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;schemas&quot;</span><span class="p">,</span>
                    <span class="s2">&quot;DBstructure-Views.png&quot;</span><span class="p">,</span>
                <span class="p">)</span>
                <span class="n">os</span><span class="o">.</span><span class="n">startfile</span><span class="p">(</span><span class="n">filepath</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">openTablesAndFields</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># self.tablefielddialog.run()</span>
        <span class="c1"># self.tablefielddialog.exec_()</span>
        <span class="c1"># self.tablefielddialog.setWindowModality(QtCore.Qt.Modal)  # NonModal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablefielddialog</span><span class="o">.</span><span class="n">dbase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dbase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablefielddialog</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablefielddialog</span><span class="o">.</span><span class="n">setModal</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tablefielddialog</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">reportBug</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;mailto:lamia@arteliagroup.com&amp;subject=Lamia bug report&quot;</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

    <span class="c1"># *************************************************************</span>
    <span class="c1"># toolbar</span>
    <span class="c1"># *************************************************************</span>

    <span class="k">def</span> <span class="nf">____________ToolBarActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_connectToolBar</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarnew</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarNew</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarmagic</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarMagic</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarundo</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarUndo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbardelete</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarDelete</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarzoomto</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarZoomTo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarzoomto</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarZoomTo</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarlinkeditor</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarEditLink</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarsave</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarSave</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomnewpoint</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarGeom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomnewline</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarGeom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomnewpolygon</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarGeom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomaddpoint</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarGeom</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomaddGPSpoint</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbarGeomAddGPS</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoobargeomeditlayer</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">addRawLayerInCanvasForEditing</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarlayersave</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveRawLayerInCanvasForEditing</span><span class="p">()</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbarlayerundo</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span>
            <span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">saveRawLayerInCanvasForEditing</span><span class="p">(</span><span class="n">savechanges</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbartoolsprint</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">printCurrentFormWidget</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbartoolsprint</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actiontoolbartoolscamera</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openCamera</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">toolbarNew</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarNew&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarNew</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="o">.</span><span class="n">toolbarNew</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarMagic</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarMagic&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarMagic</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarUndo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarUndo&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarUndo</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="o">.</span><span class="n">toolbarUndo</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarDelete</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarDelete&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarDelete</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="o">.</span><span class="n">toolbarDelete</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarZoomTo</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarZoomTo&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarZoomTo</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarEditLink</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarZoomTo&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarEditLink</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarSave</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarSave&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarSave</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currentchoosertreewidget</span><span class="o">.</span><span class="n">toolbarSave</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarGeom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarGeom&quot;</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarGeom</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">toolbarGeomAddGPS</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;called&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">and</span> <span class="nb">hasattr</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="p">,</span> <span class="s2">&quot;toolbarGeomAddGPS&quot;</span>
        <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">toolbarGeomAddGPS</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">addRawLayerInCanvasForEditing</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">currentdbasetablename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">DBASETABLENAME</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">addRawLayerInCanvasForEditing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span> <span class="n">currentdbasetablename</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">((</span><span class="n">QFrame</span><span class="p">,</span> <span class="n">QToolBar</span><span class="p">)):</span>
            <span class="n">child</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lamiatoolbareditlayer</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">saveRawLayerInCanvasForEditing</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">savechanges</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">saveRawLayerInCanvasForEditing</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dbase</span><span class="p">,</span> <span class="n">savechanges</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">child</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">((</span><span class="n">QFrame</span><span class="p">,</span> <span class="n">QToolBar</span><span class="p">)):</span>
            <span class="n">child</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">printCurrentFormWidget</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">printWidget</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">openCamera</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Linux&quot;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span> <span class="o">==</span> <span class="s2">&quot;Windows&quot;</span><span class="p">:</span>
            <span class="n">subprocess</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s2">&quot;start microsoft.windows.camera:&quot;</span><span class="p">,</span> <span class="n">shell</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># *************************************************************</span>
    <span class="c1"># menu</span>
    <span class="c1"># *************************************************************</span>

    <span class="k">def</span> <span class="nf">____________MenuActions</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">_connectMenuAndOthers</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># file menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionNouvelle_base</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">newDBase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSpatialite</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionPostgis</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">loadDBase</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionImporter_et_ajouter_la_base</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">addDBase</span><span class="p">)</span>
        <span class="c1"># self.action_pushdb.triggered.connect(self.pushDBase)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_pulldb</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="k">lambda</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">pullDBase</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionSynchronize_DB</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SynchronizeDB</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionClose_project</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">closeProject</span><span class="p">)</span>

        <span class="c1"># visual mode menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionModeExpert</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setVisualMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionTTC</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setVisualMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionModeTerrain</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setVisualMode</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionPosttraitement</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setVisualMode</span><span class="p">)</span>
        <span class="c1"># settings menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionHauteur_de_perche_GPS</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setHauteurPerche</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">menuConnect_to_port</span><span class="o">.</span><span class="n">aboutToShow</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToPort</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_GPSConnection</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">connectToGPS</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">gpsutil</span><span class="o">.</span><span class="n">GPSConnected</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GPSconnected</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">action_Repertoire_photo</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">setImageDir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_project_directory</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openProjectDir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_Lamia_directory</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openLamiaDir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionOpen_offline_project_directory</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openOfflineDir</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionShow_Hide_QGis_toolbars</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">showHideQgisToolbars</span><span class="p">)</span>

        <span class="c1"># about menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionAide</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openHelp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionConceptual_model</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openSchema</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionViews</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openSchema</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionTables_and_fields</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openTablesAndFields</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actionReport_bug</span><span class="o">.</span><span class="n">triggered</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reportBug</span><span class="p">)</span>

        <span class="c1"># others</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_selectfeat</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectFeature</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pushButton_qgspan</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panCanvas</span><span class="p">)</span>

        <span class="c1"># on exit qgis : restore toolbars</span>
        <span class="k">if</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">qgis</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">QgsProject</span><span class="o">.</span><span class="n">instance</span><span class="p">()</span><span class="o">.</span><span class="n">cleared</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_reloadQgisToolbar</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">panCanvas</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">panCanvas</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">selectFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

        <span class="n">pointemitter</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">pointEmitter</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">pointemitter</span><span class="o">.</span><span class="n">canvasClicked</span><span class="o">.</span><span class="n">disconnect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectPickedFeature</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="c1"># try:</span>
        <span class="c1">#     self.qgiscanvas.canvas.mapToolSet.disconnect(self.qgiscanvas.toolsetChanged)</span>
        <span class="c1"># except TypeError:</span>
        <span class="c1">#     pass</span>
        <span class="n">pointemitter</span><span class="o">.</span><span class="n">canvasClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">selectPickedFeature</span><span class="p">)</span>
        <span class="c1"># self.qgiscanvas.canvas.mapToolSet.connect(self.qgiscanvas.toolsetChanged)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">setMapTool</span><span class="p">(</span><span class="n">pointemitter</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">selectPickedFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">point</span><span class="p">,</span> <span class="n">tablename</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">debug</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Start </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">point</span><span class="p">))</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="n">addselection</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">modifiers</span> <span class="o">=</span> <span class="n">QApplication</span><span class="o">.</span><span class="n">keyboardModifiers</span><span class="p">()</span>
        <span class="c1"># print(&#39;modif&#39;)</span>
        <span class="c1"># if modifiers == QtCore.Qt.ShiftModifier:</span>
        <span class="k">if</span> <span class="n">modifiers</span> <span class="o">==</span> <span class="n">QtCore</span><span class="o">.</span><span class="n">Qt</span><span class="o">.</span><span class="n">ControlModifier</span><span class="p">:</span>
            <span class="c1"># print(&#39;Ctrl+Click&#39;)</span>
            <span class="n">addselection</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># get parent</span>
        <span class="n">parentwdg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span>
        <span class="k">while</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">parentWidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parentwdg</span> <span class="o">=</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">parentWidget</span>

        <span class="k">if</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">parentwdg</span><span class="p">,</span> <span class="s2">&quot;selectPickedFeature&quot;</span><span class="p">):</span>
            <span class="n">parentwdg</span><span class="o">.</span><span class="n">selectPickedFeature</span><span class="p">(</span><span class="n">point</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span>
            <span class="nb">hasattr</span><span class="p">(</span><span class="n">parentwdg</span><span class="p">,</span> <span class="s2">&quot;DBASETABLENAME&quot;</span><span class="p">)</span>
            <span class="ow">and</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">DBASETABLENAME</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="p">):</span>
            <span class="k">return</span>
        <span class="c1"># getCurrentLayer</span>
        <span class="n">tablename</span> <span class="o">=</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">DBASETABLENAME</span>
        <span class="n">fieldconstraint</span> <span class="o">=</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">TABLEFILTERFIELD</span>
        <span class="c1"># qgslayer = self.qgiscanvas.layers[tablename][&#39;layerqgis&#39;]</span>
        <span class="c1"># point2 = self.qgiscanvas.pointEmitter.toLayerCoordinates(qgslayer, point)</span>
        <span class="n">nearestpk</span><span class="p">,</span> <span class="n">dist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">qgiscanvas</span><span class="o">.</span><span class="n">getNearestPk</span><span class="p">(</span>
            <span class="n">tablename</span><span class="p">,</span>
            <span class="n">point</span><span class="p">,</span>  <span class="c1"># former point2</span>
            <span class="n">comefromcanvas</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
            <span class="n">fieldconstraint</span><span class="o">=</span><span class="n">fieldconstraint</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;Lamia_unittest&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;nearestpk </span><span class="si">%s</span><span class="s2">&quot;</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">nearestpk</span><span class="p">))</span>

        <span class="k">if</span> <span class="n">nearestpk</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># no element in table</span>
            <span class="k">return</span>
        <span class="n">parentwdg</span><span class="o">.</span><span class="n">selectFeature</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">nearestpk</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">parentwdg</span><span class="o">.</span><span class="n">choosertreewidget</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">parentwdg</span><span class="o">.</span><span class="n">choosertreewidget</span><span class="o">.</span><span class="n">selectFeature</span><span class="p">(</span><span class="n">pk</span><span class="o">=</span><span class="n">nearestpk</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">currenttoolwidget</span><span class="o">.</span><span class="n">widgetClicked</span><span class="p">()</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        if not (hasattr(self.currenttoolwidget, &#39;DBASETABLENAME&#39;) </span>
<span class="sd">                and self.currenttoolwidget.DBASETABLENAME is not None):</span>
<span class="sd">            return</span>
<span class="sd">        # getCurrentLayer</span>
<span class="sd">        tablename = self.currenttoolwidget.DBASETABLENAME</span>
<span class="sd">        #qgslayer = self.qgiscanvas.layers[tablename][&#39;layerqgis&#39;]</span>
<span class="sd">        #point2 = self.qgiscanvas.pointEmitter.toLayerCoordinates(qgslayer, point)</span>
<span class="sd">        nearestpk, dist = self.qgiscanvas.getNearestPk(tablename,</span>
<span class="sd">                                                        point,  #former point2</span>
<span class="sd">                                                        comefromcanvas=True)</span>
<span class="sd">        if nearestpk is None:   #no element in table</span>
<span class="sd">            return</span>

<span class="sd">        self.currenttoolwidget.selectFeature(pk=nearestpk)</span>

<span class="sd">        if self.currentchoosertreewidget is not None:</span>
<span class="sd">            self.currentchoosertreewidget.selectFeature(pk=nearestpk)</span>
<span class="sd">        &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">____________devFeature</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">hideDevQWidgets</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">qgis</span><span class="o">.</span><span class="n">utils</span><span class="o">.</span><span class="n">iface</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">menuConnect_to_port</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>
</pre></div>

           </div>
           
          </div>
<a href="https://github.com/Artelia/Lamia">
	<img style="position: absolute; top: 0; right: 0; border: 0;"
		src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub">
</a>
<script src="https://unpkg.com/aos@next/dist/aos.js"></script>
<script>
	AOS.init();
</script>

          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Artelia

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>