webpackHotUpdate("QWC2App",{

/***/ "./qwc2/components/StandardApp.jsx":
/*!*****************************************!*\
  !*** ./qwc2/components/StandardApp.jsx ***!
  \*****************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/* WEBPACK VAR INJECTION */(function(global) {function _createForOfIteratorHelper(o) { if (typeof Symbol === \"undefined\" || o[Symbol.iterator] == null) { if (Array.isArray(o) || (o = _unsupportedIterableToArray(o))) { var i = 0; var F = function F() {}; return { s: F, n: function n() { if (i >= o.length) return { done: true }; return { done: false, value: o[i++] }; }, e: function e(_e) { throw _e; }, f: F }; } throw new TypeError(\"Invalid attempt to iterate non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); } var it, normalCompletion = true, didErr = false, err; return { s: function s() { it = o[Symbol.iterator](); }, n: function n() { var step = it.next(); normalCompletion = step.done; return step; }, e: function e(_e2) { didErr = true; err = _e2; }, f: function f() { try { if (!normalCompletion && it[\"return\"] != null) it[\"return\"](); } finally { if (didErr) throw err; } } }; }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(n); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { return function () { var Super = _getPrototypeOf(Derived), result; if (_isNativeReflectConstruct()) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n/**\n * Copyright 2016, GeoSolutions Sas.\n * All rights reserved.\n *\n * This source code is licensed under the BSD-style license found in the\n * LICENSE file in the root directory of this source tree.\n */\nvar React = __webpack_require__(/*! react */ \"./node_modules/react/index.js\");\n\nvar PropTypes = __webpack_require__(/*! prop-types */ \"./node_modules/prop-types/index.js\");\n\nvar _require = __webpack_require__(/*! react-redux */ \"./node_modules/react-redux/es/index.js\"),\n    Provider = _require.Provider,\n    connect = _require.connect; // Needed for IE11 to avoid 'Promise not defined' error in axios\n\n\n__webpack_require__(/*! babel-polyfill */ \"./node_modules/babel-polyfill/lib/index.js\"); // Avoid Intl is not defined (Intl needed by react-intl further on)\n\n\nif (!global.Intl) {\n  __webpack_require__(/*! intl */ \"./node_modules/intl/index.js\");\n}\n\nvar axios = __webpack_require__(/*! axios */ \"./node_modules/axios/index.js\");\n\nvar assign = __webpack_require__(/*! object-assign */ \"./node_modules/object-assign/index.js\");\n\nvar isEmpty = __webpack_require__(/*! lodash.isempty */ \"./node_modules/lodash.isempty/index.js\");\n\nvar Proj4js = __webpack_require__(/*! proj4 */ \"./node_modules/proj4/lib/index.js\")[\"default\"];\n\nvar olProj4 = __webpack_require__(/*! ol/proj/proj4 */ \"./node_modules/ol/proj/proj4.js\");\n\nvar Localized = __webpack_require__(/*! ../components/I18N/Localized */ \"./qwc2/components/I18N/Localized.jsx\");\n\nvar StandardStore = __webpack_require__(/*! ../stores/StandardStore */ \"./qwc2/stores/StandardStore.js\");\n\nvar PluginsContainer = __webpack_require__(/*! ./PluginsContainer */ \"./qwc2/components/PluginsContainer.jsx\");\n\nvar _require2 = __webpack_require__(/*! ../actions/browser */ \"./qwc2/actions/browser.js\"),\n    changeBrowserProperties = _require2.changeBrowserProperties;\n\nvar _require3 = __webpack_require__(/*! ../actions/locale */ \"./qwc2/actions/locale.js\"),\n    loadLocale = _require3.loadLocale;\n\nvar _require4 = __webpack_require__(/*! ../actions/localConfig */ \"./qwc2/actions/localConfig.js\"),\n    localConfigLoaded = _require4.localConfigLoaded,\n    setStartupParameters = _require4.setStartupParameters;\n\nvar _require5 = __webpack_require__(/*! ../actions/layers */ \"./qwc2/actions/layers.js\"),\n    addLayer = _require5.addLayer;\n\nvar _require6 = __webpack_require__(/*! ../actions/search */ \"./qwc2/actions/search.js\"),\n    changeSearch = _require6.changeSearch;\n\nvar _require7 = __webpack_require__(/*! ../actions/theme */ \"./qwc2/actions/theme.js\"),\n    themesLoaded = _require7.themesLoaded,\n    setCurrentTheme = _require7.setCurrentTheme;\n\nvar ConfigUtils = __webpack_require__(/*! ../utils/ConfigUtils */ \"./qwc2/utils/ConfigUtils.js\");\n\nvar CoordinatesUtils = __webpack_require__(/*! ../utils/CoordinatesUtils */ \"./qwc2/utils/CoordinatesUtils.js\");\n\nvar LocaleUtils = __webpack_require__(/*! ../utils/LocaleUtils */ \"./qwc2/utils/LocaleUtils.js\");\n\nvar MapUtils = __webpack_require__(/*! ../utils/MapUtils */ \"./qwc2/utils/MapUtils.js\");\n\nvar PluginsUtils = __webpack_require__(/*! ../utils/PluginsUtils */ \"./qwc2/utils/PluginsUtils.js\");\n\nvar LayerUtils = __webpack_require__(/*! ../utils/LayerUtils */ \"./qwc2/utils/LayerUtils.js\");\n\nvar _require8 = __webpack_require__(/*! ../utils/PermaLinkUtils */ \"./qwc2/utils/PermaLinkUtils.js\"),\n    UrlParams = _require8.UrlParams,\n    resolvePermaLink = _require8.resolvePermaLink;\n\nvar ThemeUtils = __webpack_require__(/*! ../utils/ThemeUtils */ \"./qwc2/utils/ThemeUtils.js\");\n\n__webpack_require__(/*! ./style/App.css */ \"./qwc2/components/style/App.css\");\n\nvar AppInitComponent = /*#__PURE__*/function (_React$Component) {\n  _inherits(AppInitComponent, _React$Component);\n\n  var _super = _createSuper(AppInitComponent);\n\n  function AppInitComponent(props) {\n    var _this;\n\n    _classCallCheck(this, AppInitComponent);\n\n    _this = _super.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this), \"init\", function () {\n      _this.initialized = true; // Load themes.json\n\n      axios.get(_this.props.themes ? _this.props.themes : \"themes.json\").then(function (response) {\n        var themes = response.data.themes || {};\n\n        _this.props.themesLoaded(themes); // Resolve permalink and restore settings\n\n\n        resolvePermaLink(_this.props.initialParams, function (params, state) {\n          var theme = ThemeUtils.getThemeById(themes, params.t);\n\n          if (!theme) {\n            if (ConfigUtils.getConfigProp(\"dontLoadDefaultTheme\")) {\n              return;\n            }\n\n            theme = ThemeUtils.getThemeById(themes, themes.defaultTheme);\n            params = {};\n          }\n\n          var layerParams = params.l !== undefined ? params.l.split(\",\").filter(function (entry) {\n            return entry;\n          }) : null;\n\n          if (layerParams && ConfigUtils.getConfigProp(\"urlReverseLayerOrder\")) {\n            layerParams.reverse();\n          }\n\n          var visibleBgLayer = params.bl || params.bl === '' ? params.bl : null;\n          var initialView = null;\n\n          if (params.c && params.s !== undefined) {\n            var coords = params.c.split(/[;,]/g).map(function (x) {\n              return parseFloat(x);\n            });\n            var scales = theme.scales || themes.defaultScales;\n            var zoom = MapUtils.computeZoom(scales, params.s);\n\n            if (coords.length === 2) {\n              initialView = {\n                center: coords,\n                zoom: zoom,\n                crs: params.crs || theme.mapCrs\n              };\n            }\n          } else if (params.e) {\n            var bounds = params.e.split(/[;,]/g).map(function (x) {\n              return parseFloat(x);\n            });\n\n            if (bounds.length === 4) {\n              initialView = {\n                bounds: bounds,\n                crs: params.crs || theme.mapCrs\n              };\n            }\n          } // Clear all params\n\n\n          UrlParams.clear(); // Restore theme and layers\n\n          try {\n            _this.props.setCurrentTheme(theme, themes, false, initialView, layerParams, visibleBgLayer, state.layers, _this.props.appConfig.themeLayerRestorer, _this.props.appConfig.externalLayerRestorer);\n          } catch (e) {\n            console.log(e.stack);\n          }\n        });\n      });\n    });\n\n    _this.initialized = false;\n    return _this;\n  }\n\n  _createClass(AppInitComponent, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      // The map component needs to have finished loading before theme initialization can proceed\n      if (this.props.mapSize && !this.initialized) {\n        this.init();\n      }\n    }\n  }, {\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(newProps) {\n      // The map component needs to have finished loading before theme initialization can proceed\n      if (newProps.mapSize && !this.initialized) {\n        this.init();\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return null;\n    }\n  }]);\n\n  return AppInitComponent;\n}(React.Component);\n\n_defineProperty(AppInitComponent, \"propTypes\", {\n  appConfig: PropTypes.object,\n  initialParams: PropTypes.object,\n  mapSize: PropTypes.object,\n  themesLoaded: PropTypes.func,\n  changeSearch: PropTypes.func,\n  setCurrentTheme: PropTypes.func,\n  addLayer: PropTypes.func\n});\n\nvar AppInit = connect(function (state) {\n  return {\n    mapSize: state.map.size,\n    layers: state.layers.flat\n  };\n}, {\n  themesLoaded: themesLoaded,\n  changeSearch: changeSearch,\n  setCurrentTheme: setCurrentTheme,\n  addLayer: addLayer\n})(AppInitComponent);\n\nvar StandardApp = /*#__PURE__*/function (_React$Component2) {\n  _inherits(StandardApp, _React$Component2);\n\n  var _super2 = _createSuper(StandardApp);\n\n  function StandardApp(props) {\n    var _this2;\n\n    _classCallCheck(this, StandardApp);\n\n    _this2 = _super2.call(this, props);\n\n    _defineProperty(_assertThisInitialized(_this2), \"computeVh\", function () {\n      // https://css-tricks.com/the-trick-to-viewport-units-on-mobile/\n      document.documentElement.style.setProperty('--vh', window.innerHeight * 0.01 + 'px');\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"setupTouchEvents\", function (el) {\n      el.addEventListener('touchstart', function (ev) {\n        _this2.touchY = ev.targetTouches[0].clientY;\n      }, {\n        passive: false\n      });\n      el.addEventListener('touchmove', _this2.preventOverscroll, {\n        passive: false\n      });\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"preventOverscroll\", function (ev) {\n      var scrollEvent = false;\n      var element = ev.target;\n      var direction = ev.targetTouches[0].clientY - _this2.touchY;\n      _this2.touchY = ev.targetTouches[0].clientY;\n\n      while (!scrollEvent && element) {\n        var scrollable = element.scrollHeight > element.clientHeight; // Workaround for resizeable-window having scrollHeight > clientHeight even though it has no scrollbar\n\n        if (element.classList.contains('resizeable-window')) {\n          scrollable = false;\n        } // If it is a range element, treat it as a scroll event\n\n\n        if (element.type === \"range\") {\n          scrollEvent = true;\n        } // User scrolls down and element is not at end of scroll\n        else if (scrollable && element.scrollTop + element.clientHeight < element.scrollHeight && direction < 0) {\n            scrollEvent = true;\n          } // User scrolls up and element is not at start of scroll\n          else if (scrollable && element.scrollTop > 0 && direction > 0) {\n              scrollEvent = true;\n            } else {\n              element = element.parentElement;\n            }\n      }\n\n      if (!scrollEvent) {\n        ev.preventDefault();\n      }\n    });\n\n    _defineProperty(_assertThisInitialized(_this2), \"init\", function () {\n      // Detect browser properties\n      _this2.store.dispatch(changeBrowserProperties(ConfigUtils.getBrowserProperties())); // Load locale\n\n\n      LocaleUtils.setSupportedLocales(_this2.props.appConfig.supportedLocales); // Load config.json\n\n      ConfigUtils.loadConfiguration().then(function (config) {\n        _this2.store.dispatch(localConfigLoaded(config)); // Dispatch user locale\n\n\n        _this2.store.dispatch(loadLocale(null, LocaleUtils.getUserLocale())); // Add projections from config\n\n\n        var _iterator = _createForOfIteratorHelper(config.projections || []),\n            _step;\n\n        try {\n          for (_iterator.s(); !(_step = _iterator.n()).done;) {\n            var proj = _step.value;\n\n            if (Proj4js.defs(proj.code) === undefined) {\n              Proj4js.defs(proj.code, proj.proj);\n            }\n\n            CoordinatesUtils.setCrsLabels(_defineProperty({}, proj.code, proj.label));\n          }\n        } catch (err) {\n          _iterator.e(err);\n        } finally {\n          _iterator.f();\n        }\n\n        olProj4.register(Proj4js);\n      });\n    });\n\n    _this2.store = StandardStore(_this2.props.appConfig.initialState || {}, _this2.props.appConfig.pluginsDef.plugins, {\n      onPersist: _this2.init\n    }, _this2.props.appConfig.actionLogger);\n\n    _this2.init(); // Save initial params before they get overwritten\n\n\n    _this2.initialParams = UrlParams.getParams();\n\n    _this2.store.dispatch(setStartupParameters(_this2.initialParams));\n\n    _this2.touchY = null;\n    return _this2;\n  }\n\n  _createClass(StandardApp, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.computeVh);\n      this.computeVh();\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.computeVh);\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var plugins = assign(PluginsUtils.getPlugins(this.props.appConfig.pluginsDef.plugins));\n      return /*#__PURE__*/React.createElement(Provider, {\n        store: this.store\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        ref: this.setupTouchEvents\n      }, /*#__PURE__*/React.createElement(AppInit, {\n        initialParams: this.initialParams,\n        appConfig: this.props.appConfig\n      }), /*#__PURE__*/React.createElement(Localized, null, /*#__PURE__*/React.createElement(PluginsContainer, {\n        plugins: plugins,\n        pluginsAppConfig: this.props.appConfig.pluginsDef.cfg || {}\n      }))));\n    }\n  }]);\n\n  return StandardApp;\n}(React.Component);\n\n_defineProperty(StandardApp, \"propTypes\", {\n  appConfig: PropTypes.object\n});\n\nmodule.exports = StandardApp;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../node_modules/webpack/buildin/global.js */ \"./node_modules/webpack/buildin/global.js\")))\n\n//# sourceURL=webpack:///./qwc2/components/StandardApp.jsx?");

/***/ })

})